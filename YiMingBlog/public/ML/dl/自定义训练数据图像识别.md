---
layout: doc
title: 自定义训练数据图像识别
tags:
  - "#博文"
  - "#以撒"
  - "#深度学习"
  - "#图像识别"
datetime: 2024-01-23
time: 14:37
description: 
navbar: true
sidebar: true
footer: true
---

# 引言
![[3.png]]
最近在玩以撒的结合, ns版本. 游戏确实上头好玩, 内容很多. 但是游玩下来遇到一个纠结头疼的问题就是, 道具/ 装备 有时候捡起来后的效果, 还不如不捡.   
装备/道具只会在捡起来的时候才能看到道具和状态是什么, 甚至, 有时候捡起来后描述也看不出这个道具到底能用来干嘛,  魂系叙事那一套......虽然也找到不错的[以撒wiki]([以撒的结合中文维基 - 灰机wiki - 北京嘉闻杰诺网络科技有限公司 (huijiwiki.com)](https://isaac.huijiwiki.com/wiki/%E9%A6%96%E9%A1%B5)), 但是, 站点只能文字搜索, 再加上其道具数量有7百多个, 叠加起来就更让人头疼了. 
![[以撒自定义训练数据图像识别-2024-01-23.png]]

于是就想到, 干脆做一个“以撒道具图像识别功能” 好了, 优化体验: ) .   

# 自定义训练数据图像识别

得益于各种深度学习框架的发展, 现在训练一个模型变得非常简单, 于是我就决定直接用`pytorch`来完成这个图片识别的任务了.  考虑到以撒的道具装备这类东西图像数据是非常**垂直领域**了, 所以我需要准备对应的训练数据进行模型的训练.  

## 数据准备  

### 数据获取  
直接从[以撒的结合中文维基](https://isaac.huijiwiki.com/wiki/%E9%A6%96%E9%A1%B5) 编写爬虫把道具/装备的图片数据, 描述都抓取下来.  

### 数据处理  
直接把雪碧图切分好, 对应好他们的道具描述就好了, 比较简单. 然后放到指定的文件夹中即可. 

### pytorch 加载自定义训练数据  
安装好pytorch的运行环境,  开始定义自定义的图片的loader  

```python
import torch
from torch import nn
device = (
    "cuda"
    if torch.cuda.is_available()
    else "mps"
    if torch.backends.mps.is_available()
    else "cpu"
)
print(f"Using {device} device")
```







