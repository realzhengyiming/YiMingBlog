<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/">
    <channel>
        <title>åšæ–‡</title>
        <link>localhost/blog</link>
        <description>âœï¸</description>
        <lastBuildDate>Thu, 01 Feb 2024 08:43:54 GMT</lastBuildDate>
        <docs>https://validator.w3.org/feed/docs/rss2.html</docs>
        <generator>https://github.com/jpmonette/feed</generator>
        <language>en</language>
        <item>
            <title><![CDATA[ä»¥æ’’ç›®æ ‡æ£€æµ‹]]></title>
            <link>localhost/blog/blog/posts/2024/isaac_object_detection.html</link>
            <guid>localhost/blog/blog/posts/2024/isaac_object_detection.html</guid>
            <pubDate>Tue, 30 Jan 2024 00:00:00 GMT</pubDate>
            <description><![CDATA[<h1 id="å¼•è¨€" tabindex="-1">å¼•è¨€ <a class="header-anchor" href="#å¼•è¨€" aria-label="Permalink to &quot;å¼•è¨€&quot;">&ZeroWidthSpace;</a></h1>
<p>ä¸Šç¯‡æ–‡ç« æŠŠã€Šä»¥æ’’çš„ç»“åˆã€‹é“å…·/é¥°å“å›¾ç‰‡è¯†åˆ«çš„åšå‡ºæ¥äº†, èƒ½ç”¨æ˜¯èƒ½ç”¨, ä½†æ˜¯ä½¿ç”¨åœºæ™¯æ¯”è¾ƒç‹­éš˜, è¿˜éœ€è¦æ‹ç…§å’Œæˆªå›¾, å¾—éƒ¨ç½²åˆ°ç§»åŠ¨è®¾å¤‡+ç¼–å†™åº”ç”¨çš„å½¢å¼æ‰å¯ä»¥æ¯”è¾ƒå¥½ä½“éªŒ, çŸ­æœŸå†…ä¸å¤ªæƒ³æç§»åŠ¨app. äºæ˜¯å°±æƒ³ç€è¦ä¸ç»ƒä¸€ä¸ªç›®æ ‡æ£€æµ‹çš„æ¨¡å‹, ç„¶åé€šè¿‡ç›´æ¥æˆªå–åº”ç”¨è§†é¢‘æµçš„å½¢å¼, å®æ—¶/å°å»¶æ—¶çš„å¯¹ç”»é¢è¿›è¡Œæ¨ç†å’Œæ£€æµ‹, ä»¥<strong>å¤–æŒ‚</strong>çš„å½¢å¼æ³¨å…¥æ¸¸æˆä¸­, å¢å¼ºä½“éªŒ.<br>
äºæ˜¯å°±è¯ç”Ÿäº†æœ¬æ–‡ã€Šä»¥æ’’çš„ç»“åˆã€‹ç›®æ ‡æ£€æµ‹ ğŸ˜ƒ</p>
]]></description>
            <content:encoded><![CDATA[<h1 id="å¼•è¨€" tabindex="-1">å¼•è¨€ <a class="header-anchor" href="#å¼•è¨€" aria-label="Permalink to &quot;å¼•è¨€&quot;">&ZeroWidthSpace;</a></h1>
<p>ä¸Šç¯‡æ–‡ç« æŠŠã€Šä»¥æ’’çš„ç»“åˆã€‹é“å…·/é¥°å“å›¾ç‰‡è¯†åˆ«çš„åšå‡ºæ¥äº†, èƒ½ç”¨æ˜¯èƒ½ç”¨, ä½†æ˜¯ä½¿ç”¨åœºæ™¯æ¯”è¾ƒç‹­éš˜, è¿˜éœ€è¦æ‹ç…§å’Œæˆªå›¾, å¾—éƒ¨ç½²åˆ°ç§»åŠ¨è®¾å¤‡+ç¼–å†™åº”ç”¨çš„å½¢å¼æ‰å¯ä»¥æ¯”è¾ƒå¥½ä½“éªŒ, çŸ­æœŸå†…ä¸å¤ªæƒ³æç§»åŠ¨app. äºæ˜¯å°±æƒ³ç€è¦ä¸ç»ƒä¸€ä¸ªç›®æ ‡æ£€æµ‹çš„æ¨¡å‹, ç„¶åé€šè¿‡ç›´æ¥æˆªå–åº”ç”¨è§†é¢‘æµçš„å½¢å¼, å®æ—¶/å°å»¶æ—¶çš„å¯¹ç”»é¢è¿›è¡Œæ¨ç†å’Œæ£€æµ‹, ä»¥<strong>å¤–æŒ‚</strong>çš„å½¢å¼æ³¨å…¥æ¸¸æˆä¸­, å¢å¼ºä½“éªŒ.<br>
äºæ˜¯å°±è¯ç”Ÿäº†æœ¬æ–‡ã€Šä»¥æ’’çš„ç»“åˆã€‹ç›®æ ‡æ£€æµ‹ ğŸ˜ƒ</p>
<hr>
<h2 id="éœ€æ±‚" tabindex="-1">éœ€æ±‚ <a class="header-anchor" href="#éœ€æ±‚" aria-label="Permalink to &quot;éœ€æ±‚&quot;">&ZeroWidthSpace;</a></h2>
<p>å°±æ˜¯å®æ—¶/å°å»¶è¿Ÿçš„ç›®æ ‡æ£€æµ‹éœ€æ±‚, ç„¶åéœ€è¦æˆªå–è§†é¢‘æµçš„.</p>
<h2 id="æ¨¡å‹é€‰æ‹©" tabindex="-1">æ¨¡å‹é€‰æ‹© <a class="header-anchor" href="#æ¨¡å‹é€‰æ‹©" aria-label="Permalink to &quot;æ¨¡å‹é€‰æ‹©&quot;">&ZeroWidthSpace;</a></h2>
<h2 id="æ•°æ®å‡†å¤‡" tabindex="-1">æ•°æ®å‡†å¤‡ <a class="header-anchor" href="#æ•°æ®å‡†å¤‡" aria-label="Permalink to &quot;æ•°æ®å‡†å¤‡&quot;">&ZeroWidthSpace;</a></h2>
<h2 id="æ¨¡å‹è®­ç»ƒ" tabindex="-1">æ¨¡å‹è®­ç»ƒ <a class="header-anchor" href="#æ¨¡å‹è®­ç»ƒ" aria-label="Permalink to &quot;æ¨¡å‹è®­ç»ƒ&quot;">&ZeroWidthSpace;</a></h2>
<h2 id="éªŒè¯ç»“æœ" tabindex="-1">éªŒè¯ç»“æœ <a class="header-anchor" href="#éªŒè¯ç»“æœ" aria-label="Permalink to &quot;éªŒè¯ç»“æœ&quot;">&ZeroWidthSpace;</a></h2>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[ä»¥æ’’é“å…·/é¥°å“å›¾åƒè¯†åˆ«]]></title>
            <link>localhost/blog/blog/posts/2024/Isaac_image_recognition.html</link>
            <guid>localhost/blog/blog/posts/2024/Isaac_image_recognition.html</guid>
            <pubDate>Mon, 29 Jan 2024 00:00:00 GMT</pubDate>
            <description><![CDATA[<h1 id="å¼•è¨€" tabindex="-1">å¼•è¨€ <a class="header-anchor" href="#å¼•è¨€" aria-label="Permalink to &quot;å¼•è¨€&quot;">&ZeroWidthSpace;</a></h1>
<p><img src="./pic/è‡ªå®šä¹‰è®­ç»ƒæ•°æ®å›¾åƒè¯†åˆ«-2024-01-29.png" alt="">
æœ€è¿‘åœ¨ç©ã€Šä»¥æ’’çš„ç»“åˆ:å¿æ‚”ã€‹, nsç‰ˆæœ¬. æ¸¸æˆç¡®å®ä¸Šå¤´å¥½ç©, å†…å®¹å¾ˆå¤š. ä½†æ˜¯æ¸¸ç©ä¸‹æ¥é‡åˆ°ä¸€ä¸ªçº ç»“å¤´ç–¼çš„é—®é¢˜å°±æ˜¯, é“å…·/ è£…å¤‡ æœ‰æ—¶å€™æ¡èµ·æ¥åçš„æ•ˆæœ, è¿˜ä¸å¦‚ä¸æ¡. è£…å¤‡/é“å…·åªä¼šåœ¨æ¡èµ·æ¥çš„æ—¶å€™æ‰èƒ½çœ‹åˆ°é“å…·å’ŒçŠ¶æ€æ˜¯ä»€ä¹ˆ, ç”šè‡³, æœ‰æ—¶å€™æ¡èµ·æ¥åæè¿°ä¹Ÿçœ‹ä¸å‡ºè¿™ä¸ªé“å…·åˆ°åº•èƒ½ç”¨æ¥å¹²å˜›,  é­‚ç³»å™äº‹é‚£ä¸€å¥—......è™½ç„¶ä¹Ÿæ‰¾åˆ°ä¸é”™çš„<a href="https://isaac.huijiwiki.com/wiki/%E9%A6%96%E9%A1%B5" target="_blank" rel="noreferrer">ä»¥æ’’çš„ç»“åˆä¸­æ–‡ç»´åŸº</a>, ä½†æ˜¯, ç«™ç‚¹åªèƒ½æ–‡å­—æœç´¢, å†åŠ ä¸Šå…¶é“å…·å’Œé¥°å“åŠ èµ·æ¥æ€»æ•°é‡æœ‰900å¤šä¸ª, ç›¸å½“äºImageNetçš„ç§ç±»äº†.
äºæ˜¯å°±æƒ³åˆ°, å¹²è„†åšä¸€ä¸ªâ€œä»¥æ’’é“å…·å›¾åƒè¯†åˆ«åŠŸèƒ½â€ å¥½äº†, ä¼˜åŒ–ä½“éªŒ: ) .</p>
]]></description>
            <content:encoded><![CDATA[<h1 id="å¼•è¨€" tabindex="-1">å¼•è¨€ <a class="header-anchor" href="#å¼•è¨€" aria-label="Permalink to &quot;å¼•è¨€&quot;">&ZeroWidthSpace;</a></h1>
<p><img src="./pic/è‡ªå®šä¹‰è®­ç»ƒæ•°æ®å›¾åƒè¯†åˆ«-2024-01-29.png" alt="">
æœ€è¿‘åœ¨ç©ã€Šä»¥æ’’çš„ç»“åˆ:å¿æ‚”ã€‹, nsç‰ˆæœ¬. æ¸¸æˆç¡®å®ä¸Šå¤´å¥½ç©, å†…å®¹å¾ˆå¤š. ä½†æ˜¯æ¸¸ç©ä¸‹æ¥é‡åˆ°ä¸€ä¸ªçº ç»“å¤´ç–¼çš„é—®é¢˜å°±æ˜¯, é“å…·/ è£…å¤‡ æœ‰æ—¶å€™æ¡èµ·æ¥åçš„æ•ˆæœ, è¿˜ä¸å¦‚ä¸æ¡. è£…å¤‡/é“å…·åªä¼šåœ¨æ¡èµ·æ¥çš„æ—¶å€™æ‰èƒ½çœ‹åˆ°é“å…·å’ŒçŠ¶æ€æ˜¯ä»€ä¹ˆ, ç”šè‡³, æœ‰æ—¶å€™æ¡èµ·æ¥åæè¿°ä¹Ÿçœ‹ä¸å‡ºè¿™ä¸ªé“å…·åˆ°åº•èƒ½ç”¨æ¥å¹²å˜›,  é­‚ç³»å™äº‹é‚£ä¸€å¥—......è™½ç„¶ä¹Ÿæ‰¾åˆ°ä¸é”™çš„<a href="https://isaac.huijiwiki.com/wiki/%E9%A6%96%E9%A1%B5" target="_blank" rel="noreferrer">ä»¥æ’’çš„ç»“åˆä¸­æ–‡ç»´åŸº</a>, ä½†æ˜¯, ç«™ç‚¹åªèƒ½æ–‡å­—æœç´¢, å†åŠ ä¸Šå…¶é“å…·å’Œé¥°å“åŠ èµ·æ¥æ€»æ•°é‡æœ‰900å¤šä¸ª, ç›¸å½“äºImageNetçš„ç§ç±»äº†.
äºæ˜¯å°±æƒ³åˆ°, å¹²è„†åšä¸€ä¸ªâ€œä»¥æ’’é“å…·å›¾åƒè¯†åˆ«åŠŸèƒ½â€ å¥½äº†, ä¼˜åŒ–ä½“éªŒ: ) .</p>
<hr>
<h1 id="è‡ªå®šä¹‰è®­ç»ƒæ•°æ®å›¾åƒè¯†åˆ«" tabindex="-1">è‡ªå®šä¹‰è®­ç»ƒæ•°æ®å›¾åƒè¯†åˆ« <a class="header-anchor" href="#è‡ªå®šä¹‰è®­ç»ƒæ•°æ®å›¾åƒè¯†åˆ«" aria-label="Permalink to &quot;è‡ªå®šä¹‰è®­ç»ƒæ•°æ®å›¾åƒè¯†åˆ«&quot;">&ZeroWidthSpace;</a></h1>
<p>å¾—ç›Šäºå„ç§æ·±åº¦å­¦ä¹ æ¡†æ¶çš„å‘å±•, ç°åœ¨è®­ç»ƒä¸€ä¸ªæ¨¡å‹å˜å¾—éå¸¸ç®€å•, äºæ˜¯æˆ‘å°±å†³å®šç›´æ¥ç”¨<code>pytorch</code>æ¥å®Œæˆè¿™ä¸ªå›¾ç‰‡è¯†åˆ«çš„ä»»åŠ¡äº†.  è€ƒè™‘åˆ°ä»¥æ’’çš„é“å…·è£…å¤‡è¿™ç±»ä¸œè¥¿å›¾åƒæ•°æ®æ˜¯éå¸¸<strong>å‚ç›´é¢†åŸŸ</strong>äº†, æ‰€ä»¥æˆ‘éœ€è¦å‡†å¤‡å¯¹åº”çš„è®­ç»ƒæ•°æ®è¿›è¡Œæ¨¡å‹çš„è®­ç»ƒ.</p>
<h1 id="æ•°æ®å‡†å¤‡" tabindex="-1">æ•°æ®å‡†å¤‡ <a class="header-anchor" href="#æ•°æ®å‡†å¤‡" aria-label="Permalink to &quot;æ•°æ®å‡†å¤‡&quot;">&ZeroWidthSpace;</a></h1>
<h2 id="æ•°æ®è·å–-æ•°æ®åˆæˆ" tabindex="-1">æ•°æ®è·å–&amp;æ•°æ®åˆæˆ <a class="header-anchor" href="#æ•°æ®è·å–-æ•°æ®åˆæˆ" aria-label="Permalink to &quot;æ•°æ®è·å–&amp;æ•°æ®åˆæˆ&quot;">&ZeroWidthSpace;</a></h2>
<p>ä»<a href="https://isaac.huijiwiki.com/wiki/%E9%A6%96%E9%A1%B5" target="_blank" rel="noreferrer">ä»¥æ’’çš„ç»“åˆä¸­æ–‡ç»´åŸº</a> ç¼–å†™çˆ¬è™«æŠŠé“å…·/è£…å¤‡çš„å›¾ç‰‡æ•°æ®, æè¿°éƒ½æŠ“å–ä¸‹æ¥.<br>
çˆ¬è™«æ¯”è¾ƒç®€å•, ä¸»è¦å°±æ˜¯å›¾ç‰‡çˆ¬å–çš„æ—¶å€™, éœ€è¦ä»cssä¸­æŠŠspriteå›¾å­å›¾çš„x, yæå–å‡ºæ¥, ç„¶åè‡ªè¡Œä½¿ç”¨spriteåˆ’åˆ†ç‹¬ç«‹çš„é“å…·å›¾. ä¸‹å›¾ä¸ºcsså’Œhtmlæ ‡ç­¾ä¸­æŠ½å–å‡ºæ¥çš„ä¿¡æ¯</p>
<div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre v-pre class="shiki material-theme-palenight" ><code><span class="line"><span style="color: #89DDFF">{</span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">collectibles_001</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">:</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">{</span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">x</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">:</span><span style="color: #A6ACCD"> </span><span style="color: #F78C6C">32</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #A6ACCD">  </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">y</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">:</span><span style="color: #A6ACCD"> </span><span style="color: #F78C6C">0</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #A6ACCD">  </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">en</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">:</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">The Sad Onion</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #A6ACCD">  </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">zh</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">:</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">æ‚²ä¼¤æ´‹è‘±</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #A6ACCD">  </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">level</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">:</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">1</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #A6ACCD">  </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">type</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">:</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">é“å…·</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #A6ACCD">  </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">level2</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">:</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">3</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #A6ACCD">  </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">?</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">:</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">/</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #A6ACCD">  </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">desc</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">:</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">å°„é€Ÿä¸Šå‡ã€‚</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #A6ACCD">  </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">new_id</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">:</span><span style="color: #A6ACCD"> </span><span style="color: #F78C6C">0</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #A6ACCD">  </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">image</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">:</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">./cus_data/0.png</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">},</span><span style="color: #A6ACCD"> ...</span></span>
<span class="line"><span style="color: #89DDFF">}</span><span style="color: #A6ACCD"> </span><span style="color: #676E95; font-style: italic"># æå–å‡ºæ¯ä¸ªé“å…·çš„å›¾ç‰‡å’Œå…¶ä»–å±æ€§</span></span></code></pre>
</div><p>ç„¶åæŠŠå›¾ç‰‡åˆ†å‰²åæŸä¸ªç›®å½•, æ­¤å¤„æˆ‘æ˜¯æŠŠè£åˆ‡å¥½çš„å›¾ç‰‡å­˜æ”¾åœ¨ <code>./cus_data</code>ä¸‹. å¹¶ä¸”æŠŠå›¾ç‰‡. æ•´ç†åå¾—åˆ°è®­ç»ƒçš„ç±»åˆ«æ ‡ç­¾å¤‡ç”¨.</p>
<div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre v-pre class="shiki material-theme-palenight" ><code><span class="line"><span style="color: #89DDFF">&gt;&gt;&gt;</span><span style="color: #A6ACCD">classes</span></span>
<span class="line"><span style="color: #89DDFF">{</span><span style="color: #F78C6C">0</span><span style="color: #89DDFF">:</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">æ‚²ä¼¤æ´‹è‘±:å°„é€Ÿä¸Šå‡ã€‚</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #A6ACCD"> </span><span style="color: #F78C6C">1</span><span style="color: #89DDFF">:</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">å†…çœ¼:è§’è‰²æ¯æ¬¡å‘å°„3é¢—æ³ªå¼¹ã€‚</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #A6ACCD"> </span><span style="color: #F78C6C">2</span><span style="color: #89DDFF">:</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">å¼¯å‹ºé­”æœ¯:è§’è‰²çš„æ³ªå¼¹è·å¾—è¿½è¸ªæ•ˆæœã€‚</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #A6ACCD"> </span><span style="color: #F78C6C">3</span><span style="color: #89DDFF">:</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">æŸ¯å‰çŒ«çš„å¤´:æ³ªå¼¹å˜å¤§ï¼Œå‡»é€€æ•ˆæœä¸Šå‡ï¼Œä¼¤å®³ä¸Šå‡ã€‚</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #A6ACCD"> </span><span style="color: #F78C6C">4</span><span style="color: #89DDFF">:</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">æˆ‘çš„é•œåƒ:è§’è‰²çš„æ³ªå¼¹ä¼šé£å›è§’è‰²èº«è¾¹ã€‚</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #A6ACCD"> </span><span style="color: #F78C6C">5</span><span style="color: #89DDFF">:</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">å°å·:å°„ç¨‹ä¸‹é™ï¼Œå°„é€Ÿä¸Šå‡ã€‚</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #A6ACCD"> ...</span></span></code></pre>
</div><p>æ­¤å¤„æˆ‘æŠŠå›¾ç‰‡è£å‰ªä¸‹æ¥çš„32x32å¤§å°çš„å›¾ç‰‡ä¿å­˜ä¸ºåˆæˆè®­ç»ƒæ•°æ®çš„å…ƒæ•°æ®, å› ä¸ºæ˜¯åƒç´ é£æ ¼, æ‰€ä»¥å“ªæ€•æ‰€ç¼©å°äº†,åªè¦ä¸ä½¿ç”¨å¹³æ»‘, é‚£è¿˜æ˜¯éå¸¸æ¸…æ™°çš„.
<img src="./pic/è‡ªå®šä¹‰è®­ç»ƒæ•°æ®å›¾åƒè¯†åˆ«-åƒç´ é£æ ¼-2024-01-29.png" alt=""><br>
(æ•°æ®è·å¾—å’Œå¤„ç†å®Œæ•´ä»£ç åœ¨æœ«å°¾çš„å¼•ç”¨ä¸­ä¼šç»™å‡ºé“¾æ¥.)</p>
<h2 id="æ•°æ®å¢å¼º" tabindex="-1">æ•°æ®å¢å¼º <a class="header-anchor" href="#æ•°æ®å¢å¼º" aria-label="Permalink to &quot;æ•°æ®å¢å¼º&quot;">&ZeroWidthSpace;</a></h2>
<p>å®é™…çš„é¢„æµ‹æƒ…å†µéƒ½ä¼´éšç€å„ç§å„æ ·çš„èƒŒæ™¯å¹²æ‰°,  æ‰€ä»¥è¿™è¾¹éœ€è¦åœ¨åˆæˆè®­ç»ƒæ•°æ®çš„æ—¶å€™, ä¹Ÿéœ€è¦è®©è¿™äº›å…ƒå›¾æ ‡æ‹¥æœ‰å„ç§å„æ ·çš„èƒŒæ™¯.
<img src="./pic/è‡ªå®šä¹‰è®­ç»ƒæ•°æ®å›¾åƒè¯†åˆ«-æ•°æ®åˆæˆå¤šèƒŒæ™¯-2024-01-29.png" alt="">
å¦ä¸€æ–¹é¢, è€ƒè™‘åˆ°ä¸€ä¸ªåœºæ™¯å°±æ˜¯ä½¿ç”¨æ‘„åƒå¤´çš„æ‹ç…§çš„æ—¶å€™, å¯èƒ½ä¼šæœ‰çš„ä¸€äº›å›¾åƒçš„ç•¸å˜å’Œå˜å½¢ç­‰. transformä¸­ä¹Ÿéœ€è¦é…ç½®æ•°æ®å¢å¼ºçš„æ“ä½œ, åŒ…æ‹¬ä½†ä¸é™äº, æŠ–åŠ¨, æ˜æš—åº¦å˜åŒ–ç­‰.</p>
<div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre v-pre class="shiki material-theme-palenight" ><code><span class="line"><span style="color: #89DDFF; font-style: italic">from</span><span style="color: #A6ACCD"> torchvision</span><span style="color: #89DDFF">.</span><span style="color: #A6ACCD">transforms </span><span style="color: #89DDFF; font-style: italic">import</span><span style="color: #A6ACCD"> ToTensor</span></span>
<span class="line"></span>
<span class="line"><span style="color: #A6ACCD">transform </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> transforms</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">Compose</span><span style="color: #89DDFF">(</span></span>
<span class="line"><span style="color: #82AAFF">    </span><span style="color: #89DDFF">[</span></span>
<span class="line"><span style="color: #82AAFF">        transforms</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">Lambda</span><span style="color: #89DDFF">(</span><span style="color: #C792EA">lambda</span><span style="color: #82AAFF"> </span><span style="color: #A6ACCD; font-style: italic">x</span><span style="color: #89DDFF">:</span><span style="color: #82AAFF"> x</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">float</span><span style="color: #89DDFF">()),</span></span>
<span class="line"><span style="color: #82AAFF">    </span><span style="color: #89DDFF">])</span><span style="color: #A6ACCD"> </span><span style="color: #676E95; font-style: italic"># å…ˆç›´æ¥é…ç½®ä¸€ä¸ªç”¨æ¥è®¡ç®— æ•°æ®å‡å€¼å’Œæ ‡å‡†å·®,ä»¥æ–¹ä¾¿æ­£åˆ™åŒ–</span></span>
<span class="line"></span>
<span class="line"><span style="color: #676E95; font-style: italic"># é…ç½®åˆå§‹çš„dataloaderç”¨äºéå†å’Œè®¡ç®—å‡å€¼å’Œæ ‡å‡†å·®</span></span>
<span class="line"><span style="color: #89DDFF; font-style: italic">from</span><span style="color: #A6ACCD"> torchvision</span><span style="color: #89DDFF">.</span><span style="color: #A6ACCD">io </span><span style="color: #89DDFF; font-style: italic">import</span><span style="color: #A6ACCD"> read_image</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C792EA">class</span><span style="color: #A6ACCD"> </span><span style="color: #FFCB6B">IssacCustomDatasets</span><span style="color: #89DDFF">(</span><span style="color: #FFCB6B">Dataset</span><span style="color: #89DDFF">):</span></span>
<span class="line"><span style="color: #A6ACCD">    </span><span style="color: #C792EA">def</span><span style="color: #A6ACCD"> </span><span style="color: #82AAFF">__init__</span><span style="color: #89DDFF">(</span><span style="color: #F07178; font-style: italic">self</span><span style="color: #89DDFF">,</span><span style="color: #A6ACCD"> </span><span style="color: #A6ACCD; font-style: italic">img_sort_files</span><span style="color: #89DDFF">,</span><span style="color: #A6ACCD"> </span></span>
<span class="line"><span style="color: #A6ACCD">                 </span><span style="color: #A6ACCD; font-style: italic">img_dir</span><span style="color: #89DDFF">,</span><span style="color: #A6ACCD"> </span><span style="color: #A6ACCD; font-style: italic">transform</span><span style="color: #89DDFF">=None,</span><span style="color: #A6ACCD"> </span></span>
<span class="line"><span style="color: #A6ACCD">                </span><span style="color: #A6ACCD; font-style: italic">target_transform</span><span style="color: #89DDFF">=None):</span></span>
<span class="line"><span style="color: #A6ACCD">        self</span><span style="color: #89DDFF">.</span><span style="color: #F07178">img_labels</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> img_sort_files</span></span>
<span class="line"><span style="color: #A6ACCD">        </span><span style="color: #676E95; font-style: italic"># è‡ªå®šä¹‰æ ‡ç­¾å…³ç³», æ­¤å¤„éœ€è¦æ’å¥½åºçš„</span></span>
<span class="line"><span style="color: #A6ACCD">        self</span><span style="color: #89DDFF">.</span><span style="color: #F07178">img_dir</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> img_dir</span></span>
<span class="line"><span style="color: #A6ACCD">        self</span><span style="color: #89DDFF">.</span><span style="color: #F07178">transform</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> transform</span></span>
<span class="line"><span style="color: #A6ACCD">        self</span><span style="color: #89DDFF">.</span><span style="color: #F07178">target_transform</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> target_transform</span></span>
<span class="line"><span style="color: #A6ACCD">        </span></span>
<span class="line"><span style="color: #A6ACCD">    </span><span style="color: #C792EA">def</span><span style="color: #A6ACCD"> </span><span style="color: #82AAFF">__len__</span><span style="color: #89DDFF">(</span><span style="color: #F07178; font-style: italic">self</span><span style="color: #89DDFF">):</span></span>
<span class="line"><span style="color: #A6ACCD">        </span><span style="color: #89DDFF; font-style: italic">return</span><span style="color: #A6ACCD"> </span><span style="color: #82AAFF">len</span><span style="color: #89DDFF">(</span><span style="color: #A6ACCD">self</span><span style="color: #89DDFF">.</span><span style="color: #F07178">img_labels</span><span style="color: #89DDFF">)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #A6ACCD">    </span><span style="color: #C792EA">def</span><span style="color: #A6ACCD"> </span><span style="color: #82AAFF">__getitem__</span><span style="color: #89DDFF">(</span><span style="color: #F07178; font-style: italic">self</span><span style="color: #89DDFF">,</span><span style="color: #A6ACCD"> </span><span style="color: #A6ACCD; font-style: italic">idx</span><span style="color: #89DDFF">):</span><span style="color: #A6ACCD">  </span><span style="color: #676E95; font-style: italic"># ä½œç”¨æ˜¯è·å¾—label å’Œ item å³å¯</span></span>
<span class="line"><span style="color: #A6ACCD">        filename </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> self</span><span style="color: #89DDFF">.</span><span style="color: #F07178">img_labels</span><span style="color: #89DDFF">[</span><span style="color: #F07178">idx</span><span style="color: #89DDFF">]</span><span style="color: #A6ACCD">        </span></span>
<span class="line"><span style="color: #A6ACCD">        img_path </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> os</span><span style="color: #89DDFF">.</span><span style="color: #F07178">path</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">join</span><span style="color: #89DDFF">(</span><span style="color: #A6ACCD">self</span><span style="color: #89DDFF">.</span><span style="color: #F07178">img_dir</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> filename</span><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #A6ACCD">        image </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> </span><span style="color: #82AAFF">read_image</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">img_path</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #A6ACCD; font-style: italic">mode</span><span style="color: #89DDFF">=</span><span style="color: #82AAFF">torchvision</span><span style="color: #89DDFF">.</span><span style="color: #F07178">io</span><span style="color: #89DDFF">.</span><span style="color: #F07178">image</span><span style="color: #89DDFF">.</span><span style="color: #F07178">ImageReadMode</span><span style="color: #89DDFF">.</span><span style="color: #F07178">RGB</span><span style="color: #89DDFF">)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #A6ACCD">        label </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> </span><span style="color: #FFCB6B">int</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">filename</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">split</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">.</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">)[</span><span style="color: #F78C6C">0</span><span style="color: #89DDFF">])</span></span>
<span class="line"><span style="color: #A6ACCD">        </span><span style="color: #89DDFF; font-style: italic">if</span><span style="color: #A6ACCD"> self</span><span style="color: #89DDFF">.</span><span style="color: #F07178">transform</span><span style="color: #89DDFF">:</span></span>
<span class="line"><span style="color: #A6ACCD">            image </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> self</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">transform</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">image</span><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #A6ACCD">        </span><span style="color: #89DDFF; font-style: italic">if</span><span style="color: #A6ACCD"> self</span><span style="color: #89DDFF">.</span><span style="color: #F07178">target_transform</span><span style="color: #89DDFF">:</span></span>
<span class="line"><span style="color: #A6ACCD">            label </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> self</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">target_transform</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">label</span><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #A6ACCD">        </span><span style="color: #89DDFF; font-style: italic">return</span><span style="color: #A6ACCD"> image</span><span style="color: #89DDFF">,</span><span style="color: #A6ACCD"> label</span></span>
<span class="line"></span>
<span class="line"><span style="color: #A6ACCD">from_dir </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">new_cus_data</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #A6ACCD">need_move_images </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> os</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">listdir</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">new_cus_data/</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #A6ACCD">need_move_images </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">[</span><span style="color: #A6ACCD">i </span><span style="color: #89DDFF; font-style: italic">for</span><span style="color: #A6ACCD"> i </span><span style="color: #89DDFF; font-style: italic">in</span><span style="color: #A6ACCD"> need_move_images </span><span style="color: #89DDFF; font-style: italic">if</span><span style="color: #A6ACCD"> </span><span style="color: #FFCB6B">int</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">i</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">split</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">.</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">)[</span><span style="color: #F78C6C">0</span><span style="color: #89DDFF">])</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">]</span></span>
<span class="line"><span style="color: #A6ACCD">need_move_images</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">sort</span><span style="color: #89DDFF">(</span><span style="color: #A6ACCD; font-style: italic">key</span><span style="color: #89DDFF">=</span><span style="color: #C792EA">lambda</span><span style="color: #82AAFF"> </span><span style="color: #A6ACCD; font-style: italic">x</span><span style="color: #89DDFF">:</span><span style="color: #82AAFF"> </span><span style="color: #C792EA">f</span><span style="color: #C3E88D">&quot;</span><span style="color: #F78C6C">{</span><span style="color: #FFCB6B">int</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">x</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">split</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">.</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">)[</span><span style="color: #F78C6C">0</span><span style="color: #89DDFF">])</span><span style="color: #C792EA">:03d</span><span style="color: #F78C6C">}</span><span style="color: #C3E88D">&quot;</span><span style="color: #82AAFF"> </span><span style="color: #89DDFF">+</span><span style="color: #82AAFF"> </span><span style="color: #C792EA">f</span><span style="color: #C3E88D">&quot;</span><span style="color: #F78C6C">{</span><span style="color: #82AAFF">x</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">split</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">.</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">)[</span><span style="color: #F78C6C">1</span><span style="color: #89DDFF">]</span><span style="color: #F78C6C">}</span><span style="color: #C3E88D">&quot;</span><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #82AAFF">print</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">len</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">need_move_images</span><span style="color: #89DDFF">))</span></span>
<span class="line"></span>
<span class="line"><span style="color: #A6ACCD">train_dataset </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> </span><span style="color: #82AAFF">IssacCustomDatasets</span><span style="color: #89DDFF">(</span><span style="color: #A6ACCD; font-style: italic">img_sort_files</span><span style="color: #89DDFF">=</span><span style="color: #82AAFF">need_move_images</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #A6ACCD; font-style: italic">img_dir</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">new_cus_data/</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #82AAFF">                                    </span><span style="color: #A6ACCD; font-style: italic">transform</span><span style="color: #89DDFF">=</span><span style="color: #82AAFF">transform</span><span style="color: #89DDFF">)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #676E95; font-style: italic">## dataloader</span></span>
<span class="line"><span style="color: #A6ACCD">train_dataloader </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> </span><span style="color: #82AAFF">DataLoader</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">train_dataset</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span></span>
<span class="line"><span style="color: #82AAFF">                              </span><span style="color: #A6ACCD; font-style: italic">batch_size</span><span style="color: #89DDFF">=</span><span style="color: #82AAFF">batch_size</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span></span>
<span class="line"><span style="color: #82AAFF">                              </span><span style="color: #A6ACCD; font-style: italic">shuffle</span><span style="color: #89DDFF">=True)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #676E95; font-style: italic"># è·å–å›¾ç‰‡æ•°æ®çš„ å½’ä¸€åŒ–æ•°å€¼</span></span>
<span class="line"><span style="color: #A6ACCD">global_mean </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">[]</span></span>
<span class="line"><span style="color: #A6ACCD">global_std </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">[]</span></span>
<span class="line"><span style="color: #89DDFF; font-style: italic">for</span><span style="color: #A6ACCD"> images</span><span style="color: #89DDFF">,</span><span style="color: #A6ACCD"> labels </span><span style="color: #89DDFF; font-style: italic">in</span><span style="color: #A6ACCD"> train_dataloader</span><span style="color: #89DDFF">:</span></span>
<span class="line"><span style="color: #A6ACCD">    numpy_image </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> images</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">numpy</span><span style="color: #89DDFF">()</span></span>
<span class="line"><span style="color: #A6ACCD">    batch_mean </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> np</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">mean</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">numpy_image</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #A6ACCD; font-style: italic">axis</span><span style="color: #89DDFF">=(</span><span style="color: #F78C6C">0</span><span style="color: #89DDFF">,</span><span style="color: #F78C6C">2</span><span style="color: #89DDFF">,</span><span style="color: #F78C6C">3</span><span style="color: #89DDFF">))</span></span>
<span class="line"><span style="color: #A6ACCD">    batch_std </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> np</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">std</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">numpy_image</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #A6ACCD; font-style: italic">axis</span><span style="color: #89DDFF">=(</span><span style="color: #F78C6C">0</span><span style="color: #89DDFF">,</span><span style="color: #F78C6C">2</span><span style="color: #89DDFF">,</span><span style="color: #F78C6C">3</span><span style="color: #89DDFF">))</span></span>
<span class="line"><span style="color: #A6ACCD">    global_mean</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">append</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">batch_mean</span><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #A6ACCD">    global_std</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">append</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">batch_std</span><span style="color: #89DDFF">)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #A6ACCD">global_mean </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> np</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">mean</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">global_mean</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #A6ACCD; font-style: italic">axis</span><span style="color: #89DDFF">=</span><span style="color: #F78C6C">0</span><span style="color: #89DDFF">).</span><span style="color: #82AAFF">tolist</span><span style="color: #89DDFF">()</span></span>
<span class="line"><span style="color: #A6ACCD">global_std </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> np</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">mean</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">global_std</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #A6ACCD; font-style: italic">axis</span><span style="color: #89DDFF">=</span><span style="color: #F78C6C">0</span><span style="color: #89DDFF">).</span><span style="color: #82AAFF">tolist</span><span style="color: #89DDFF">()</span></span>
<span class="line"><span style="color: #82AAFF">print</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">global_mean</span><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #82AAFF">print</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">global_std</span><span style="color: #89DDFF">)</span></span></code></pre>
</div><p>å†æ¬¡æ ¹æ®å¾—åˆ°çš„å‡å€¼å’Œæ ‡å‡†å·®æ›´æ–°è®­ç»ƒç”¨çš„dataloader</p>
<div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre v-pre class="shiki material-theme-palenight" ><code><span class="line"><span style="color: #89DDFF; font-style: italic">from</span><span style="color: #A6ACCD"> torchvision</span><span style="color: #89DDFF">.</span><span style="color: #A6ACCD">transforms </span><span style="color: #89DDFF; font-style: italic">import</span><span style="color: #A6ACCD"> ToTensor</span></span>
<span class="line"><span style="color: #A6ACCD">        </span></span>
<span class="line"><span style="color: #A6ACCD">transform </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> transforms</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">Compose</span><span style="color: #89DDFF">(</span></span>
<span class="line"><span style="color: #82AAFF">    </span><span style="color: #89DDFF">[</span></span>
<span class="line"><span style="color: #82AAFF">        transforms</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">RandomAffine</span><span style="color: #89DDFF">(</span><span style="color: #A6ACCD; font-style: italic">degrees</span><span style="color: #89DDFF">=</span><span style="color: #F78C6C">0</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #A6ACCD; font-style: italic">translate</span><span style="color: #89DDFF">=None,</span><span style="color: #82AAFF"> </span><span style="color: #A6ACCD; font-style: italic">scale</span><span style="color: #89DDFF">=(</span><span style="color: #F78C6C">0.9</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #F78C6C">1.1</span><span style="color: #89DDFF">),</span><span style="color: #82AAFF"> </span><span style="color: #A6ACCD; font-style: italic">shear</span><span style="color: #89DDFF">=None),</span><span style="color: #82AAFF">  </span></span>
<span class="line"><span style="color: #82AAFF">        </span><span style="color: #676E95; font-style: italic"># éšæœºæ”¾å¤§æˆ–è€…ç¼©å°ä¸€ç‚¹ç‚¹</span></span>
<span class="line"><span style="color: #82AAFF">        </span><span style="color: #676E95; font-style: italic"># å¢åŠ å™ªå£°, é˜²æ­¢è¿‡æ‹Ÿåˆ</span></span>
<span class="line"><span style="color: #82AAFF">        transforms</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">ColorJitter</span><span style="color: #89DDFF">(</span></span>
<span class="line"><span style="color: #82AAFF">            </span><span style="color: #A6ACCD; font-style: italic">brightness</span><span style="color: #89DDFF">=</span><span style="color: #F78C6C">0.1</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #82AAFF">            </span><span style="color: #A6ACCD; font-style: italic">contrast</span><span style="color: #89DDFF">=</span><span style="color: #F78C6C">0.1</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #82AAFF">            </span><span style="color: #A6ACCD; font-style: italic">saturation</span><span style="color: #89DDFF">=</span><span style="color: #F78C6C">0.1</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #82AAFF">            </span><span style="color: #A6ACCD; font-style: italic">hue</span><span style="color: #89DDFF">=</span><span style="color: #F78C6C">0.1</span><span style="color: #89DDFF">),</span><span style="color: #82AAFF">  </span><span style="color: #676E95; font-style: italic"># æŠ–åŠ¨å›¾åƒçš„äº®åº¦ã€å¯¹æ¯”åº¦ã€é¥±å’Œåº¦å’Œè‰²ç›¸</span></span>
<span class="line"><span style="color: #82AAFF">        transforms</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">Lambda</span><span style="color: #89DDFF">(</span><span style="color: #C792EA">lambda</span><span style="color: #82AAFF"> </span><span style="color: #A6ACCD; font-style: italic">x</span><span style="color: #89DDFF">:</span><span style="color: #82AAFF"> x</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">float</span><span style="color: #89DDFF">()),</span></span>
<span class="line"><span style="color: #82AAFF">        transforms</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">Normalize</span><span style="color: #89DDFF">(</span></span>
<span class="line"><span style="color: #82AAFF">            global_mean</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #82AAFF">            global_std</span></span>
<span class="line"><span style="color: #82AAFF">        </span><span style="color: #89DDFF">)</span><span style="color: #82AAFF">  </span><span style="color: #676E95; font-style: italic"># å¯¹å›¾ç‰‡æ•°æ®åšæ­£åˆ™åŒ–</span></span>
<span class="line"><span style="color: #82AAFF">    </span><span style="color: #89DDFF">])</span></span>
<span class="line"></span>
<span class="line"><span style="color: #A6ACCD">train_dataset </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> </span><span style="color: #82AAFF">IssacCustomDatasets</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">need_move_images</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #A6ACCD; font-style: italic">img_dir</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">new_cus_data/</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #A6ACCD; font-style: italic">transform</span><span style="color: #89DDFF">=</span><span style="color: #82AAFF">transform</span><span style="color: #89DDFF">)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #676E95; font-style: italic">## dataloader</span></span>
<span class="line"><span style="color: #A6ACCD">train_dataloader </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> </span><span style="color: #82AAFF">DataLoader</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">train_dataset</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span></span>
<span class="line"><span style="color: #82AAFF">                              </span><span style="color: #A6ACCD; font-style: italic">batch_size</span><span style="color: #89DDFF">=</span><span style="color: #82AAFF">batch_size</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span></span>
<span class="line"><span style="color: #82AAFF">                              </span><span style="color: #A6ACCD; font-style: italic">shuffle</span><span style="color: #89DDFF">=True)</span></span></code></pre>
</div><h1 id="è®­ç»ƒæ¨¡å‹" tabindex="-1">è®­ç»ƒæ¨¡å‹ <a class="header-anchor" href="#è®­ç»ƒæ¨¡å‹" aria-label="Permalink to &quot;è®­ç»ƒæ¨¡å‹&quot;">&ZeroWidthSpace;</a></h1>
<h2 id="è‡ªå®šä¹‰æ¨¡å‹" tabindex="-1">è‡ªå®šä¹‰æ¨¡å‹ <a class="header-anchor" href="#è‡ªå®šä¹‰æ¨¡å‹" aria-label="Permalink to &quot;è‡ªå®šä¹‰æ¨¡å‹&quot;">&ZeroWidthSpace;</a></h2>
<p>å› ä¸ºå›¾ç‰‡è¯†åˆ«ä»»åŠ¡è¾“å…¥çš„å›¾ç‰‡æ¯”è¾ƒç®€å•, æ‰€ä»¥æˆ‘è¿™å„¿ç›´æ¥ç”¨vgg16æ¥è®­ç»ƒä¸€ä¸ªå°æ¨¡å‹å°±å¯ä»¥äº†. åŸç‰ˆçš„vgg16æ˜¯åŸºäº244x244çš„ImageNetçš„å›¾ç‰‡è¾“å…¥, æ­¤å¤„æˆ‘é€šè¿‡ç»§æ‰¿è°ƒæ•´äº†æ± åŒ–å±‚çš„7x7çš„ç‰¹å¾å›¾çš„è¾“å…¥, ä»¥è®©ä»–æ”¯æŒ32x32çš„è¾“å…¥è¿˜æœ‰æœ€åçš„å…¨è¿æ¥å±‚çš„è¾“å‡º.</p>
<div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre v-pre class="shiki material-theme-palenight" ><code><span class="line"><span style="color: #89DDFF; font-style: italic">import</span><span style="color: #A6ACCD"> torch</span></span>
<span class="line"><span style="color: #89DDFF; font-style: italic">from</span><span style="color: #A6ACCD"> torch </span><span style="color: #89DDFF; font-style: italic">import</span><span style="color: #A6ACCD"> nn</span></span>
<span class="line"><span style="color: #89DDFF; font-style: italic">from</span><span style="color: #A6ACCD"> torchvision</span><span style="color: #89DDFF">.</span><span style="color: #A6ACCD">models </span><span style="color: #89DDFF; font-style: italic">import</span><span style="color: #A6ACCD"> vgg16</span></span>
<span class="line"><span style="color: #89DDFF; font-style: italic">import</span><span style="color: #A6ACCD"> torch</span><span style="color: #89DDFF">.</span><span style="color: #F07178">optim</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF; font-style: italic">as</span><span style="color: #A6ACCD"> optim</span></span>
<span class="line"><span style="color: #89DDFF; font-style: italic">import</span><span style="color: #A6ACCD"> numpy </span><span style="color: #89DDFF; font-style: italic">as</span><span style="color: #A6ACCD"> np</span></span>
<span class="line"></span>
<span class="line"><span style="color: #A6ACCD">device </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">(</span></span>
<span class="line"><span style="color: #A6ACCD">    </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">cuda</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #A6ACCD">    </span><span style="color: #89DDFF; font-style: italic">if</span><span style="color: #A6ACCD"> torch</span><span style="color: #89DDFF">.</span><span style="color: #F07178">cuda</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">is_available</span><span style="color: #89DDFF">()</span></span>
<span class="line"><span style="color: #A6ACCD">    </span><span style="color: #89DDFF; font-style: italic">else</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">mps</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #A6ACCD">    </span><span style="color: #89DDFF; font-style: italic">if</span><span style="color: #A6ACCD"> torch</span><span style="color: #89DDFF">.</span><span style="color: #F07178">backends</span><span style="color: #89DDFF">.</span><span style="color: #F07178">mps</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">is_available</span><span style="color: #89DDFF">()</span></span>
<span class="line"><span style="color: #A6ACCD">    </span><span style="color: #89DDFF; font-style: italic">else</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">cpu</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #82AAFF">print</span><span style="color: #89DDFF">(</span><span style="color: #C792EA">f</span><span style="color: #C3E88D">&quot;Using </span><span style="color: #F78C6C">{</span><span style="color: #82AAFF">device</span><span style="color: #F78C6C">}</span><span style="color: #C3E88D"> device&quot;</span><span style="color: #89DDFF">)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #A6ACCD">total_classes </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> </span><span style="color: #FFCB6B">list</span><span style="color: #89DDFF">(</span><span style="color: #FFCB6B">set</span><span style="color: #89DDFF">([</span><span style="color: #82AAFF">i</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">split</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">.</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">)[</span><span style="color: #F78C6C">0</span><span style="color: #89DDFF">]</span><span style="color: #82AAFF"> </span><span style="color: #89DDFF; font-style: italic">for</span><span style="color: #82AAFF"> i </span><span style="color: #89DDFF; font-style: italic">in</span><span style="color: #82AAFF"> need_move_images</span><span style="color: #89DDFF">]))</span></span>
<span class="line"><span style="color: #A6ACCD">total_classes_num </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> </span><span style="color: #82AAFF">len</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">total_classes</span><span style="color: #89DDFF">)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #676E95; font-style: italic">## å¤§æ‰¹é‡æµ‹è¯•</span></span>
<span class="line"><span style="color: #89DDFF; font-style: italic">from</span><span style="color: #A6ACCD"> matplotlib </span><span style="color: #89DDFF; font-style: italic">import</span><span style="color: #A6ACCD"> pyplot </span><span style="color: #89DDFF; font-style: italic">as</span><span style="color: #A6ACCD"> plt</span></span>
<span class="line"><span style="color: #89DDFF; font-style: italic">from</span><span style="color: #A6ACCD"> torchvision</span><span style="color: #89DDFF">.</span><span style="color: #A6ACCD">utils </span><span style="color: #89DDFF; font-style: italic">import</span><span style="color: #A6ACCD"> make_grid</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C792EA">class</span><span style="color: #A6ACCD"> </span><span style="color: #FFCB6B">VGG16_S</span><span style="color: #89DDFF">(</span><span style="color: #FFCB6B">nn</span><span style="color: #89DDFF">.</span><span style="color: #FFCB6B">Module</span><span style="color: #89DDFF">):</span></span>
<span class="line"><span style="color: #A6ACCD">    </span><span style="color: #C792EA">def</span><span style="color: #A6ACCD"> </span><span style="color: #82AAFF">__init__</span><span style="color: #89DDFF">(</span><span style="color: #F07178; font-style: italic">self</span><span style="color: #89DDFF">,</span><span style="color: #A6ACCD"> </span><span style="color: #A6ACCD; font-style: italic">num_classes</span><span style="color: #89DDFF">):</span></span>
<span class="line"><span style="color: #A6ACCD">        </span><span style="color: #FFCB6B">super</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">VGG16_S</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #A6ACCD">self</span><span style="color: #89DDFF">).</span><span style="color: #82AAFF">__init__</span><span style="color: #89DDFF">()</span></span>
<span class="line"><span style="color: #A6ACCD">        model </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> </span><span style="color: #82AAFF">vgg16</span><span style="color: #89DDFF">(</span><span style="color: #A6ACCD; font-style: italic">pretrained</span><span style="color: #89DDFF">=True)</span><span style="color: #A6ACCD">  </span><span style="color: #676E95; font-style: italic"># å¯ä»¥é€‰æ‹©False å’ŒTrue </span></span>
<span class="line"><span style="color: #A6ACCD">        self</span><span style="color: #89DDFF">.</span><span style="color: #F07178">features</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> model</span><span style="color: #89DDFF">.</span><span style="color: #F07178">features</span><span style="color: #A6ACCD">  </span><span style="color: #676E95; font-style: italic"># åªå–äº†feature</span></span>
<span class="line"><span style="color: #A6ACCD">        self</span><span style="color: #89DDFF">.</span><span style="color: #F07178">classifier</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> nn</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">Sequential</span><span style="color: #89DDFF">(</span></span>
<span class="line"><span style="color: #82AAFF">            nn</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">Linear</span><span style="color: #89DDFF">(</span><span style="color: #F78C6C">512</span><span style="color: #82AAFF"> </span><span style="color: #89DDFF">*</span><span style="color: #82AAFF"> </span><span style="color: #F78C6C">1</span><span style="color: #82AAFF"> </span><span style="color: #89DDFF">*</span><span style="color: #82AAFF"> </span><span style="color: #F78C6C">1</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #F78C6C">4096</span><span style="color: #89DDFF">),</span><span style="color: #82AAFF">  </span><span style="color: #676E95; font-style: italic"># ä¿®æ”¹æ­¤å¤„çš„ç¬¬ä¸€ä¸ªå‚æ•°ç”¨æ¥é€‚é…64*64</span></span>
<span class="line"><span style="color: #82AAFF">            nn</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">ReLU</span><span style="color: #89DDFF">(True),</span></span>
<span class="line"><span style="color: #82AAFF">            nn</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">Dropout</span><span style="color: #89DDFF">(),</span></span>
<span class="line"><span style="color: #82AAFF">            nn</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">Linear</span><span style="color: #89DDFF">(</span><span style="color: #F78C6C">4096</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #F78C6C">4096</span><span style="color: #89DDFF">),</span></span>
<span class="line"><span style="color: #82AAFF">            nn</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">ReLU</span><span style="color: #89DDFF">(True),</span></span>
<span class="line"><span style="color: #82AAFF">            nn</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">Dropout</span><span style="color: #89DDFF">(),</span></span>
<span class="line"><span style="color: #82AAFF">            nn</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">Linear</span><span style="color: #89DDFF">(</span><span style="color: #F78C6C">4096</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> num_classes</span><span style="color: #89DDFF">),</span></span>
<span class="line"><span style="color: #82AAFF">        </span><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #A6ACCD">        </span></span>
<span class="line"><span style="color: #A6ACCD">    </span><span style="color: #C792EA">def</span><span style="color: #A6ACCD"> </span><span style="color: #82AAFF">forward</span><span style="color: #89DDFF">(</span><span style="color: #F07178; font-style: italic">self</span><span style="color: #89DDFF">,</span><span style="color: #A6ACCD"> </span><span style="color: #A6ACCD; font-style: italic">x</span><span style="color: #89DDFF">):</span></span>
<span class="line"><span style="color: #A6ACCD">        x </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> self</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">features</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">x</span><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #A6ACCD">        x </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> x</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">view</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">x</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">size</span><span style="color: #89DDFF">(</span><span style="color: #F78C6C">0</span><span style="color: #89DDFF">),</span><span style="color: #82AAFF"> </span><span style="color: #89DDFF">-</span><span style="color: #F78C6C">1</span><span style="color: #89DDFF">)</span><span style="color: #A6ACCD"> </span></span>
<span class="line"><span style="color: #A6ACCD">        x </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> self</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">classifier</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">x</span><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #A6ACCD">        </span><span style="color: #89DDFF; font-style: italic">return</span><span style="color: #A6ACCD"> x</span></span></code></pre>
</div><h2 id="è®­ç»ƒè¯†åˆ«æ¨¡å‹" tabindex="-1">è®­ç»ƒè¯†åˆ«æ¨¡å‹ <a class="header-anchor" href="#è®­ç»ƒè¯†åˆ«æ¨¡å‹" aria-label="Permalink to &quot;è®­ç»ƒè¯†åˆ«æ¨¡å‹&quot;">&ZeroWidthSpace;</a></h2>
<p>ä½¿ç”¨å¤šä¸ªä¸åŒèƒŒæ™¯åˆæˆçš„è®­ç»ƒæ•°æ®å’Œæ•°æ®å¢å¼ºå, æˆ‘ä»¬è·å¾—äº† 10872 çš„æ€»è®­ç»ƒæ•°æ®, 921ä¸ªç±». ç„¶åå°±å¯ä»¥è¿›è¡Œç›¸å…³çš„è®­ç»ƒäº†. (æ•°æ®é‡å®åœ¨ä¸ç®—å¤ªå¤š, æ‰€ä»¥å·æ‡’ç›´æ¥å›æŠ½æ ·è®­ç»ƒæ•°æ®éªŒè¯å¥½äº†)</p>
<div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre v-pre class="shiki material-theme-palenight" ><code><span class="line"><span style="color: #89DDFF">%%</span><span style="color: #A6ACCD">time</span></span>
<span class="line"><span style="color: #676E95; font-style: italic"># è®­ç»ƒæ¨¡å‹</span></span>
<span class="line"></span>
<span class="line"><span style="color: #A6ACCD">net </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> </span><span style="color: #82AAFF">VGG16_S</span><span style="color: #89DDFF">(</span><span style="color: #A6ACCD; font-style: italic">num_classes</span><span style="color: #89DDFF">=</span><span style="color: #82AAFF">total_classes_num</span><span style="color: #89DDFF">).</span><span style="color: #82AAFF">to</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">device</span><span style="color: #89DDFF">)</span><span style="color: #A6ACCD">  </span><span style="color: #676E95; font-style: italic"># è¿™æ¬¡è®­ç»ƒ64 * 64çš„ç‰ˆæœ¬</span></span>
<span class="line"></span>
<span class="line"><span style="color: #A6ACCD">criterion </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> nn</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">CrossEntropyLoss</span><span style="color: #89DDFF">()</span></span>
<span class="line"><span style="color: #A6ACCD">optimizer </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> optim</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">Adam</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">net</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">parameters</span><span style="color: #89DDFF">(),</span><span style="color: #82AAFF"> </span><span style="color: #A6ACCD; font-style: italic">lr</span><span style="color: #89DDFF">=</span><span style="color: #F78C6C">0.0001</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #A6ACCD; font-style: italic">weight_decay</span><span style="color: #89DDFF">=</span><span style="color: #F78C6C">0.01</span><span style="color: #89DDFF">)</span><span style="color: #A6ACCD">  </span><span style="color: #676E95; font-style: italic"># åŠ å…¥äº†l2æ­£åˆ™åŒ–</span></span>
<span class="line"></span>
<span class="line"><span style="color: #A6ACCD">check_iter </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> </span><span style="color: #F78C6C">10</span><span style="color: #A6ACCD"> </span><span style="color: #676E95; font-style: italic"># train check batch size </span></span>
<span class="line"><span style="color: #A6ACCD">train_epoch </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> </span><span style="color: #F78C6C">25</span></span>
<span class="line"><span style="color: #A6ACCD">prefix </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> </span><span style="color: #C792EA">f</span><span style="color: #C3E88D">&quot;20240128_full_32x32_clear_</span><span style="color: #F78C6C">{</span><span style="color: #A6ACCD">total_classes_num</span><span style="color: #F78C6C">}</span><span style="color: #C3E88D">class_l2_2-&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #82AAFF">print</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">batch_size</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> batch_size</span><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #89DDFF; font-style: italic">for</span><span style="color: #A6ACCD"> epoch </span><span style="color: #89DDFF; font-style: italic">in</span><span style="color: #A6ACCD"> </span><span style="color: #82AAFF">range</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">train_epoch</span><span style="color: #89DDFF">):</span></span>
<span class="line"><span style="color: #A6ACCD">    net</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">train</span><span style="color: #89DDFF">()</span><span style="color: #A6ACCD">  </span><span style="color: #676E95; font-style: italic"># æ¯ä¸ªepoch ååˆ‡æ¢è®­ç»ƒæ¨¡å¼, é‚£ä¹ˆä¼šä¸ä¼šä¿dç•™ä¹‹å‰çš„è®­ç»ƒæƒé‡å‘¢?</span></span>
<span class="line"><span style="color: #A6ACCD">    </span></span>
<span class="line"><span style="color: #A6ACCD">    progress_bar </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> </span><span style="color: #82AAFF">tqdm</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">enumerate</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">train_dataloader</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #F78C6C">0</span><span style="color: #89DDFF">),</span><span style="color: #82AAFF"> </span><span style="color: #A6ACCD; font-style: italic">total</span><span style="color: #89DDFF">=</span><span style="color: #82AAFF">len</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">train_dataloader</span><span style="color: #89DDFF">))</span></span>
<span class="line"><span style="color: #A6ACCD">    </span><span style="color: #89DDFF; font-style: italic">for</span><span style="color: #A6ACCD"> i</span><span style="color: #89DDFF">,</span><span style="color: #A6ACCD"> data </span><span style="color: #89DDFF; font-style: italic">in</span><span style="color: #A6ACCD"> progress_bar</span><span style="color: #89DDFF">:</span></span>
<span class="line"><span style="color: #A6ACCD">        inputs</span><span style="color: #89DDFF">,</span><span style="color: #A6ACCD"> labels </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> data  </span><span style="color: #676E95; font-style: italic"># å¿…é¡»è¦float å½’ä¸€åŒ–? æµ®ç‚¹ç±»å‹.</span></span>
<span class="line"><span style="color: #A6ACCD">        inputs</span><span style="color: #89DDFF">,</span><span style="color: #A6ACCD"> labels </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> inputs</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">float</span><span style="color: #89DDFF">().</span><span style="color: #82AAFF">to</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">device</span><span style="color: #89DDFF">),</span><span style="color: #A6ACCD"> labels</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">to</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">device</span><span style="color: #89DDFF">)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #A6ACCD">        optimizer</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">zero_grad</span><span style="color: #89DDFF">()</span></span>
<span class="line"><span style="color: #A6ACCD">        outputs </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> </span><span style="color: #82AAFF">net</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">inputs</span><span style="color: #89DDFF">)</span><span style="color: #A6ACCD">  </span><span style="color: #676E95; font-style: italic"># è¿™ä¸€æ­¥, è¿è¡Œæœ‰é—®é¢˜, è¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢, æ£€æŸ¥ä¸€ä¸‹å›¾ç‰‡æ ¼å¼</span></span>
<span class="line"></span>
<span class="line"><span style="color: #A6ACCD">        loss </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> </span><span style="color: #82AAFF">criterion</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">outputs</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> labels</span><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #A6ACCD">        loss</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">backward</span><span style="color: #89DDFF">()</span></span>
<span class="line"><span style="color: #A6ACCD">        optimizer</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">step</span><span style="color: #89DDFF">()</span></span>
<span class="line"><span style="color: #A6ACCD">        progress_bar</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">set_description</span><span style="color: #89DDFF">(</span><span style="color: #C792EA">f</span><span style="color: #C3E88D">&#39;epoch:</span><span style="color: #F78C6C">{</span><span style="color: #82AAFF">epoch</span><span style="color: #F78C6C">}</span><span style="color: #C3E88D">, loss: </span><span style="color: #F78C6C">{</span><span style="color: #82AAFF">loss </span><span style="color: #89DDFF">/</span><span style="color: #82AAFF"> batch_size</span><span style="color: #C792EA">:.3f</span><span style="color: #F78C6C">}</span><span style="color: #C3E88D">&#39;</span><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #A6ACCD">    </span></span>
<span class="line"><span style="color: #A6ACCD">    </span><span style="color: #89DDFF; font-style: italic">if</span><span style="color: #A6ACCD"> epoch </span><span style="color: #89DDFF">%</span><span style="color: #A6ACCD"> </span><span style="color: #F78C6C">1</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">==</span><span style="color: #A6ACCD"> </span><span style="color: #F78C6C">0</span><span style="color: #89DDFF">:</span><span style="color: #A6ACCD">  </span><span style="color: #676E95; font-style: italic"># æ¯ä¸¤ä¸ªepochè¿›è¡Œä¸€æ¬¡éªŒè¯</span></span>
<span class="line"><span style="color: #A6ACCD">        </span><span style="color: #82AAFF">print</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">å¼€å§‹éªŒè¯....</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #A6ACCD">        net</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">eval</span><span style="color: #89DDFF">()</span></span>
<span class="line"><span style="color: #A6ACCD">        correct </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> </span><span style="color: #F78C6C">0</span><span style="color: #A6ACCD">  </span><span style="color: #676E95; font-style: italic"># è®°å½•æ­£ç¡®é¢„æµ‹çš„æ•°é‡</span></span>
<span class="line"><span style="color: #A6ACCD">        total </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> </span><span style="color: #F78C6C">0</span><span style="color: #A6ACCD">  </span><span style="color: #676E95; font-style: italic"># æ€»çš„æ ·æœ¬æ•°</span></span>
<span class="line"><span style="color: #A6ACCD">        </span><span style="color: #89DDFF; font-style: italic">with</span><span style="color: #A6ACCD"> torch</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">no_grad</span><span style="color: #89DDFF">():</span></span>
<span class="line"><span style="color: #A6ACCD">            </span></span>
<span class="line"><span style="color: #A6ACCD">            progress_bar2 </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> </span><span style="color: #82AAFF">tqdm</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">enumerate</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">train_dataloader</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #F78C6C">0</span><span style="color: #89DDFF">),</span><span style="color: #82AAFF"> </span><span style="color: #A6ACCD; font-style: italic">total</span><span style="color: #89DDFF">=</span><span style="color: #FFCB6B">int</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">len</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">train_dataloader</span><span style="color: #89DDFF">)</span><span style="color: #82AAFF"> </span><span style="color: #89DDFF">*</span><span style="color: #82AAFF"> </span><span style="color: #F78C6C">0.4</span><span style="color: #89DDFF">))</span></span>
<span class="line"><span style="color: #A6ACCD">            </span><span style="color: #89DDFF; font-style: italic">for</span><span style="color: #A6ACCD"> i</span><span style="color: #89DDFF">,</span><span style="color: #A6ACCD"> data </span><span style="color: #89DDFF; font-style: italic">in</span><span style="color: #A6ACCD"> progress_bar2</span><span style="color: #89DDFF">:</span></span>
<span class="line"><span style="color: #A6ACCD">                </span><span style="color: #89DDFF; font-style: italic">if</span><span style="color: #A6ACCD"> i </span><span style="color: #89DDFF">&gt;=</span><span style="color: #A6ACCD"> </span><span style="color: #FFCB6B">int</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">len</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">train_dataloader</span><span style="color: #89DDFF">)</span><span style="color: #82AAFF"> </span><span style="color: #89DDFF">*</span><span style="color: #82AAFF"> </span><span style="color: #F78C6C">0.4</span><span style="color: #89DDFF">):</span></span>
<span class="line"><span style="color: #A6ACCD">                    </span><span style="color: #89DDFF; font-style: italic">break</span></span>
<span class="line"><span style="color: #A6ACCD">                inputs</span><span style="color: #89DDFF">,</span><span style="color: #A6ACCD"> labels </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> data</span></span>
<span class="line"><span style="color: #A6ACCD">                inputs</span><span style="color: #89DDFF">,</span><span style="color: #A6ACCD"> labels </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> inputs</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">float</span><span style="color: #89DDFF">().</span><span style="color: #82AAFF">to</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">device</span><span style="color: #89DDFF">),</span><span style="color: #A6ACCD"> labels</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">to</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">device</span><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #A6ACCD">                outputs </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> </span><span style="color: #82AAFF">net</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">inputs</span><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #A6ACCD">                _</span><span style="color: #89DDFF">,</span><span style="color: #A6ACCD"> predicted </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> torch</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">max</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">outputs</span><span style="color: #89DDFF">.</span><span style="color: #F07178">data</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #F78C6C">1</span><span style="color: #89DDFF">)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #A6ACCD">                total </span><span style="color: #89DDFF">+=</span><span style="color: #A6ACCD"> labels</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">size</span><span style="color: #89DDFF">(</span><span style="color: #F78C6C">0</span><span style="color: #89DDFF">)</span><span style="color: #A6ACCD">  </span><span style="color: #676E95; font-style: italic"># å®é™…çš„æ ·æœ¬æ•°</span></span>
<span class="line"><span style="color: #A6ACCD">                correct </span><span style="color: #89DDFF">+=</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">(</span><span style="color: #A6ACCD">predicted </span><span style="color: #89DDFF">==</span><span style="color: #A6ACCD"> labels</span><span style="color: #89DDFF">).</span><span style="color: #82AAFF">sum</span><span style="color: #89DDFF">().</span><span style="color: #82AAFF">item</span><span style="color: #89DDFF">()</span><span style="color: #A6ACCD">  </span><span style="color: #676E95; font-style: italic"># æ­£ç¡®é¢„æµ‹çš„æ ·æœ¬æ•°</span></span>
<span class="line"><span style="color: #A6ACCD">        </span></span>
<span class="line"><span style="color: #A6ACCD">        accuracy </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> </span><span style="color: #82AAFF">round</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">correct </span><span style="color: #89DDFF">/</span><span style="color: #82AAFF"> total </span><span style="color: #89DDFF">*</span><span style="color: #82AAFF"> </span><span style="color: #F78C6C">100</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #F78C6C">3</span><span style="color: #89DDFF">)</span><span style="color: #A6ACCD">  </span><span style="color: #676E95; font-style: italic"># è®¡ç®—å‡†ç¡®ç‡</span></span>
<span class="line"><span style="color: #A6ACCD">        </span><span style="color: #82AAFF">print</span><span style="color: #89DDFF">(</span><span style="color: #C792EA">f</span><span style="color: #C3E88D">&#39;epoch: </span><span style="color: #F78C6C">{</span><span style="color: #82AAFF">epoch</span><span style="color: #F78C6C">}</span><span style="color: #C3E88D">, Accuracy: </span><span style="color: #F78C6C">{</span><span style="color: #82AAFF">accuracy</span><span style="color: #C792EA">:.3f</span><span style="color: #F78C6C">}</span><span style="color: #C3E88D">&#39;</span><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #A6ACCD">        </span><span style="color: #89DDFF; font-style: italic">if</span><span style="color: #A6ACCD"> accuracy </span><span style="color: #89DDFF">&gt;=</span><span style="color: #A6ACCD"> </span><span style="color: #F78C6C">60</span><span style="color: #89DDFF">:</span><span style="color: #A6ACCD">  </span><span style="color: #676E95; font-style: italic"># å¤ªå°çš„æ ¹æœ¬æ²¡æ¯”è¾ƒä¿å­˜</span></span>
<span class="line"><span style="color: #A6ACCD">            save_model_path </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> </span><span style="color: #C792EA">f</span><span style="color: #C3E88D">&quot;</span><span style="color: #F78C6C">{</span><span style="color: #A6ACCD">prefix</span><span style="color: #F78C6C">}</span><span style="color: #C3E88D">_vgg16_</span><span style="color: #F78C6C">{</span><span style="color: #A6ACCD">epoch</span><span style="color: #F78C6C">}</span><span style="color: #C3E88D">_</span><span style="color: #F78C6C">{</span><span style="color: #A6ACCD">accuracy</span><span style="color: #F78C6C">}</span><span style="color: #C3E88D">.pth&quot;</span></span>
<span class="line"><span style="color: #A6ACCD">            torch</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">save</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">net</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">state_dict</span><span style="color: #89DDFF">(),</span><span style="color: #82AAFF"> save_model_path</span><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #A6ACCD">            </span><span style="color: #82AAFF">print</span><span style="color: #89DDFF">(</span><span style="color: #C792EA">f</span><span style="color: #C3E88D">&quot;model save: &quot;</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> save_model_path</span><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #A6ACCD">        </span></span>
<span class="line"><span style="color: #A6ACCD">    torch</span><span style="color: #89DDFF">.</span><span style="color: #F07178">cuda</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">empty_cache</span><span style="color: #89DDFF">()</span></span>
<span class="line"><span style="color: #82AAFF">print</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">Finished Training</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #A6ACCD">save_model_path </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> </span><span style="color: #C792EA">f</span><span style="color: #C3E88D">&quot;</span><span style="color: #F78C6C">{</span><span style="color: #A6ACCD">prefix</span><span style="color: #F78C6C">}</span><span style="color: #C3E88D">_vgg16_</span><span style="color: #F78C6C">{</span><span style="color: #A6ACCD">epoch</span><span style="color: #F78C6C">}</span><span style="color: #C3E88D">_</span><span style="color: #F78C6C">{</span><span style="color: #A6ACCD">accuracy</span><span style="color: #F78C6C">}</span><span style="color: #C3E88D">.pth&quot;</span></span>
<span class="line"><span style="color: #A6ACCD">torch</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">save</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">net</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">state_dict</span><span style="color: #89DDFF">(),</span><span style="color: #82AAFF"> save_model_path</span><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #82AAFF">print</span><span style="color: #89DDFF">(</span><span style="color: #C792EA">f</span><span style="color: #C3E88D">&quot;model save: &quot;</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> save_model_path</span><span style="color: #89DDFF">)</span></span></code></pre>
</div><h1 id="éªŒè¯è®­ç»ƒæˆæœ" tabindex="-1">éªŒè¯è®­ç»ƒæˆæœ <a class="header-anchor" href="#éªŒè¯è®­ç»ƒæˆæœ" aria-label="Permalink to &quot;éªŒè¯è®­ç»ƒæˆæœ&quot;">&ZeroWidthSpace;</a></h1>
<p>ç»è¿‡å¤šæ¬¡è®­ç»ƒéªŒè¯, æœ€ç»ˆè®¾ç½®25epoch, æ¯è½®ä¿å­˜ç»“æœå, å¾—åˆ°äº†å¤šä¸ª90ä»¥ä¸Šå‡†ç¡®ç‡çš„ç»“æœ, è¿™ä¹‹åæˆ‘è¿˜è®©ä»–è®­ç»ƒäº†é¢å¤–çš„10è½®, ä½†æ˜¯å‡†ç¡®ç‡éƒ½æ²¡æœ‰å†æå‡,åè€Œçªä¸‹é™äº†, è¯´æ˜åç»­æ›´å¤šçš„epochå°±æ˜¯è¿‡æ‹Ÿåˆäº†, ä¸éœ€è¦å†å¢åŠ è½®æ•°.<br>
æœ€ç»ˆæˆ‘æ‰ç”¨äº†16 epochçš„æ¨¡å‹ç»“æœ:</p>
<div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre v-pre class="shiki material-theme-palenight" ><code><span class="line"><span style="color: #A6ACCD">epoch: 16, Accuracy: 98.001</span></span>
<span class="line"><span style="color: #A6ACCD">model save:  20240128_full_32x32_clear_906class_l2_2-_vgg16_16_98.001.pth</span></span></code></pre>
</div><h2 id="éªŒè¯ä»£ç " tabindex="-1">éªŒè¯ä»£ç  <a class="header-anchor" href="#éªŒè¯ä»£ç " aria-label="Permalink to &quot;éªŒè¯ä»£ç &quot;">&ZeroWidthSpace;</a></h2>
<p>è¯»å–æ¨¡å‹, å¹¶ä¸”ä½¿ç”¨æ‰‹æœºæ‹ç…§çš„æˆªå›¾, å¹¶ä½¿ç”¨çœŸå®å›¾ç‰‡è¿›è¡ŒéªŒè¯:</p>
<div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre v-pre class="shiki material-theme-palenight" ><code><span class="line"><span style="color: #A6ACCD">model_path </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">20240128_full_32x32_clear_906class_l2_2-_vgg16_16_98.001.pth</span><span style="color: #89DDFF">&quot;</span><span style="color: #A6ACCD">  </span><span style="color: #676E95; font-style: italic"># è¿™ä¸ªæ•ˆæœä¹Ÿä¸é”™ 19, çœ‹ç¬¬ä¸€/ç¬¬äºŒä¸ª</span></span>
<span class="line"></span>
<span class="line"><span style="color: #A6ACCD">model </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> </span><span style="color: #82AAFF">VGG16_S</span><span style="color: #89DDFF">(</span><span style="color: #A6ACCD; font-style: italic">num_classes</span><span style="color: #89DDFF">=</span><span style="color: #82AAFF">total_classes_num</span><span style="color: #89DDFF">).</span><span style="color: #82AAFF">to</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">device</span><span style="color: #89DDFF">)</span><span style="color: #A6ACCD"> </span></span>
<span class="line"><span style="color: #A6ACCD">model</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">load_state_dict</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">torch</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">load</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">model_path</span><span style="color: #89DDFF">))</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C792EA">def</span><span style="color: #A6ACCD"> </span><span style="color: #82AAFF">get_real_label</span><span style="color: #89DDFF">(</span><span style="color: #A6ACCD; font-style: italic">class_index</span><span style="color: #89DDFF">):</span></span>
<span class="line"><span style="color: #A6ACCD">    </span><span style="color: #89DDFF; font-style: italic">return</span><span style="color: #A6ACCD"> label_dict</span><span style="color: #89DDFF">[</span><span style="color: #A6ACCD">class_index</span><span style="color: #89DDFF">]</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C792EA">def</span><span style="color: #A6ACCD"> </span><span style="color: #82AAFF">eval_predict</span><span style="color: #89DDFF">(</span><span style="color: #A6ACCD; font-style: italic">model</span><span style="color: #89DDFF">,</span><span style="color: #A6ACCD"> </span><span style="color: #A6ACCD; font-style: italic">image_path</span><span style="color: #89DDFF">):</span></span>
<span class="line"><span style="color: #A6ACCD">    image </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> </span><span style="color: #82AAFF">read_image</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">image_path</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #A6ACCD; font-style: italic">mode</span><span style="color: #89DDFF">=</span><span style="color: #82AAFF">torchvision</span><span style="color: #89DDFF">.</span><span style="color: #F07178">io</span><span style="color: #89DDFF">.</span><span style="color: #F07178">image</span><span style="color: #89DDFF">.</span><span style="color: #F07178">ImageReadMode</span><span style="color: #89DDFF">.</span><span style="color: #F07178">RGB</span><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #A6ACCD">    inner_transform </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> transforms</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">Compose</span><span style="color: #89DDFF">(</span></span>
<span class="line"><span style="color: #82AAFF">    </span><span style="color: #89DDFF">[</span></span>
<span class="line"><span style="color: #82AAFF">        transforms</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">Resize</span><span style="color: #89DDFF">((</span><span style="color: #F78C6C">32</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #F78C6C">32</span><span style="color: #89DDFF">)),</span><span style="color: #82AAFF"> </span></span>
<span class="line"><span style="color: #82AAFF">        transforms</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">ColorJitter</span><span style="color: #89DDFF">(</span></span>
<span class="line"><span style="color: #82AAFF">            </span><span style="color: #A6ACCD; font-style: italic">brightness</span><span style="color: #89DDFF">=</span><span style="color: #F78C6C">0.1</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #82AAFF">            </span><span style="color: #A6ACCD; font-style: italic">contrast</span><span style="color: #89DDFF">=</span><span style="color: #F78C6C">0.1</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #82AAFF">            </span><span style="color: #A6ACCD; font-style: italic">saturation</span><span style="color: #89DDFF">=</span><span style="color: #F78C6C">0.1</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #82AAFF">            </span><span style="color: #A6ACCD; font-style: italic">hue</span><span style="color: #89DDFF">=</span><span style="color: #F78C6C">0.1</span><span style="color: #89DDFF">),</span><span style="color: #82AAFF">  </span><span style="color: #676E95; font-style: italic"># æŠ–åŠ¨å›¾åƒçš„äº®åº¦ã€å¯¹æ¯”åº¦ã€é¥±å’Œåº¦å’Œè‰²ç›¸</span></span>
<span class="line"><span style="color: #82AAFF">        transforms</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">Lambda</span><span style="color: #89DDFF">(</span><span style="color: #C792EA">lambda</span><span style="color: #82AAFF"> </span><span style="color: #A6ACCD; font-style: italic">x</span><span style="color: #89DDFF">:</span><span style="color: #82AAFF"> x</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">float</span><span style="color: #89DDFF">()),</span></span>
<span class="line"><span style="color: #82AAFF">        transforms</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">Normalize</span><span style="color: #89DDFF">(</span></span>
<span class="line"><span style="color: #82AAFF">            global_mean</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #82AAFF">            global_std</span></span>
<span class="line"><span style="color: #82AAFF">        </span><span style="color: #89DDFF">)</span><span style="color: #82AAFF">  </span><span style="color: #676E95; font-style: italic"># å¯¹å›¾ç‰‡æ•°æ®åšæ­£åˆ™åŒ–</span></span>
<span class="line"><span style="color: #82AAFF">    </span><span style="color: #89DDFF">])</span></span>
<span class="line"><span style="color: #A6ACCD">    model</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">eval</span><span style="color: #89DDFF">()</span></span>
<span class="line"><span style="color: #A6ACCD">    timg </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> </span><span style="color: #82AAFF">inner_transform</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">image</span><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #A6ACCD">    timg </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> timg</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">to</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">device</span><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #A6ACCD">    timg1 </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> timg</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">unsqueeze</span><span style="color: #89DDFF">(</span><span style="color: #F78C6C">0</span><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #A6ACCD">    result </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> </span><span style="color: #82AAFF">model</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">timg1</span><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #A6ACCD">    _</span><span style="color: #89DDFF">,</span><span style="color: #A6ACCD"> predicted </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> torch</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">max</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">result</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #F78C6C">1</span><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #A6ACCD">    </span><span style="color: #82AAFF">get_real_label</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">predicted</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">item</span><span style="color: #89DDFF">())</span></span>
<span class="line"><span style="color: #A6ACCD">    </span><span style="color: #89DDFF; font-style: italic">return</span><span style="color: #A6ACCD"> result</span><span style="color: #89DDFF">,</span><span style="color: #A6ACCD"> predicted```</span></span>
<span class="line"></span>
<span class="line"><span style="color: #676E95; font-style: italic">## éªŒè¯ç»“æœå¯è§†åŒ–   </span></span>
<span class="line"></span>
<span class="line"><span style="color: #A6ACCD">æ¨ç†</span><span style="color: #89DDFF">,</span><span style="color: #A6ACCD"> å¹¶ä¸”å¾—åˆ°å‰10ä¸ªæœ€åƒçš„ç±»å‹</span><span style="color: #89DDFF">,</span><span style="color: #A6ACCD"> ä¼˜åŒ–ç”¨æˆ·ä½“éªŒ</span><span style="color: #89DDFF">.</span><span style="color: #F07178"> å› ä¸ºè®­ç»ƒæ•°æ®æœ‰é™</span><span style="color: #89DDFF">,</span><span style="color: #A6ACCD"> æ‰€ä»¥æ‰ç”¨å¢åŠ å¬å›æ•°é‡å’Œæ˜¾ç¤ºå„ä¸ªç§ç±»è¯†åˆ«ç‡çš„å½¢å¼ç»™ç”¨æˆ·é€‰æ‹©</span><span style="color: #89DDFF">.</span><span style="color: #F07178">æ¯•ç«Ÿ</span><span style="color: #89DDFF">,</span><span style="color: #A6ACCD">æœ¬è´¨æ˜¯æ–¹ä¾¿ç”¨æˆ·è¯†åˆ«é“å…·ç±»å‹</span><span style="color: #89DDFF">.</span><span style="color: #F07178">  </span></span>
<span class="line"><span style="color: #A6ACCD">```python</span></span>
<span class="line"><span style="color: #89DDFF; font-style: italic">import</span><span style="color: #A6ACCD"> torch</span><span style="color: #89DDFF">.</span><span style="color: #F07178">nn</span><span style="color: #89DDFF">.</span><span style="color: #F07178">functional</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF; font-style: italic">as</span><span style="color: #A6ACCD"> F</span></span>
<span class="line"><span style="color: #89DDFF; font-style: italic">from</span><span style="color: #A6ACCD"> PIL </span><span style="color: #89DDFF; font-style: italic">import</span><span style="color: #A6ACCD"> Image</span><span style="color: #89DDFF">,</span><span style="color: #A6ACCD"> ImageDraw</span><span style="color: #89DDFF">,</span><span style="color: #A6ACCD"> ImageFont</span></span>
<span class="line"></span>
<span class="line"><span style="color: #A6ACCD">real_test_images </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">[</span><span style="color: #A6ACCD">i </span><span style="color: #89DDFF; font-style: italic">for</span><span style="color: #A6ACCD"> i </span><span style="color: #89DDFF; font-style: italic">in</span><span style="color: #A6ACCD"> os</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">listdir</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">cus_test_data/</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">)</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF; font-style: italic">if</span><span style="color: #A6ACCD"> i</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">find</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">.</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">)</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">!=</span><span style="color: #A6ACCD"> </span><span style="color: #F78C6C">0</span><span style="color: #89DDFF">]</span></span>
<span class="line"><span style="color: #82AAFF">print</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">len</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">real_test_images</span><span style="color: #89DDFF">))</span></span>
<span class="line"></span>
<span class="line"><span style="color: #89DDFF; font-style: italic">for</span><span style="color: #A6ACCD"> t_image_path </span><span style="color: #89DDFF; font-style: italic">in</span><span style="color: #A6ACCD"> real_test_images</span><span style="color: #89DDFF">:</span></span>
<span class="line"><span style="color: #A6ACCD">    </span><span style="color: #82AAFF">print</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">real label: </span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> image_path</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">split</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">/</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">)[-</span><span style="color: #F78C6C">1</span><span style="color: #89DDFF">])</span><span style="color: #A6ACCD">    </span></span>
<span class="line"><span style="color: #A6ACCD">    </span></span>
<span class="line"><span style="color: #A6ACCD">    t_image_path </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> os</span><span style="color: #89DDFF">.</span><span style="color: #F07178">path</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">join</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">cus_test_data</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> t_image_path</span><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #A6ACCD">    t_image </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> Image</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">open</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">t_image_path</span><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #A6ACCD">    t_image </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> t_image</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">resize</span><span style="color: #89DDFF">((</span><span style="color: #F78C6C">32</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #F78C6C">32</span><span style="color: #89DDFF">))</span></span>
<span class="line"><span style="color: #A6ACCD">    result</span><span style="color: #89DDFF">,</span><span style="color: #A6ACCD"> predicted </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> </span><span style="color: #82AAFF">eval_predict</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">model</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> t_image_path</span><span style="color: #89DDFF">)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #A6ACCD">    probabilities </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> F</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">softmax</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">result</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #A6ACCD; font-style: italic">dim</span><span style="color: #89DDFF">=</span><span style="color: #F78C6C">1</span><span style="color: #89DDFF">)</span><span style="color: #A6ACCD">  </span></span>
<span class="line"><span style="color: #A6ACCD">    values</span><span style="color: #89DDFF">,</span><span style="color: #A6ACCD"> indices </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> torch</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">topk</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">probabilities</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #F78C6C">10</span><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #A6ACCD">    match_images </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">[</span><span style="color: #A6ACCD">t_image</span><span style="color: #89DDFF">]</span></span>
<span class="line"><span style="color: #A6ACCD">    </span><span style="color: #89DDFF; font-style: italic">for</span><span style="color: #A6ACCD"> p</span><span style="color: #89DDFF">,</span><span style="color: #A6ACCD"> i </span><span style="color: #89DDFF; font-style: italic">in</span><span style="color: #A6ACCD"> </span><span style="color: #82AAFF">zip</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">values</span><span style="color: #89DDFF">[</span><span style="color: #F78C6C">0</span><span style="color: #89DDFF">].</span><span style="color: #82AAFF">tolist</span><span style="color: #89DDFF">(),</span><span style="color: #82AAFF"> indices</span><span style="color: #89DDFF">[</span><span style="color: #F78C6C">0</span><span style="color: #89DDFF">].</span><span style="color: #82AAFF">tolist</span><span style="color: #89DDFF">()):</span></span>
<span class="line"><span style="color: #A6ACCD">        data </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> </span><span style="color: #82AAFF">get_real_label</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">i</span><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #A6ACCD">        </span><span style="color: #82AAFF">print</span><span style="color: #89DDFF">(</span><span style="color: #C792EA">f</span><span style="color: #C3E88D">&quot;</span><span style="color: #F78C6C">{</span><span style="color: #82AAFF">data</span><span style="color: #89DDFF">[</span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">en</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">]</span><span style="color: #F78C6C">}</span><span style="color: #C3E88D"> </span><span style="color: #F78C6C">{</span><span style="color: #82AAFF">data</span><span style="color: #89DDFF">[</span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">zh</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">]</span><span style="color: #F78C6C">}</span><span style="color: #C3E88D">: </span><span style="color: #F78C6C">{</span><span style="color: #82AAFF">round</span><span style="color: #89DDFF">(</span><span style="color: #F78C6C">100</span><span style="color: #89DDFF">*</span><span style="color: #82AAFF">p</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #F78C6C">2</span><span style="color: #89DDFF">)</span><span style="color: #F78C6C">}</span><span style="color: #C3E88D">%&quot;</span><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #A6ACCD">        match_img </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> Image</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">open</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">data</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">get</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">image</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">))</span></span>
<span class="line"><span style="color: #A6ACCD">        </span><span style="color: #676E95; font-style: italic"># åˆ›å»ºä¸€ä¸ªå¯ä»¥åœ¨ç»™å®šå›¾åƒä¸Šç»˜å›¾çš„å¯¹è±¡</span></span>
<span class="line"><span style="color: #A6ACCD">        draw </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> ImageDraw</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">Draw</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">match_img</span><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #A6ACCD">        </span><span style="color: #676E95; font-style: italic"># å­—ä½“é¢œè‰²</span></span>
<span class="line"><span style="color: #A6ACCD">        font_color </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">(</span><span style="color: #F78C6C">232</span><span style="color: #89DDFF">,</span><span style="color: #F78C6C">98</span><span style="color: #89DDFF">,</span><span style="color: #F78C6C">85</span><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #A6ACCD">        </span><span style="color: #676E95; font-style: italic"># ç»˜åˆ¶æ–‡æœ¬</span></span>
<span class="line"><span style="color: #A6ACCD">        draw</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">text</span><span style="color: #89DDFF">((</span><span style="color: #F78C6C">0</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #F78C6C">0</span><span style="color: #89DDFF">),</span><span style="color: #82AAFF"> </span><span style="color: #C792EA">f</span><span style="color: #C3E88D">&quot;</span><span style="color: #F78C6C">{</span><span style="color: #82AAFF">round</span><span style="color: #89DDFF">(</span><span style="color: #F78C6C">100</span><span style="color: #89DDFF">*</span><span style="color: #82AAFF">p</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #F78C6C">1</span><span style="color: #89DDFF">)</span><span style="color: #F78C6C">}</span><span style="color: #C3E88D">%&quot;</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #A6ACCD; font-style: italic">fill</span><span style="color: #89DDFF">=</span><span style="color: #82AAFF">font_color</span><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #A6ACCD">        match_images</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">append</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">match_img</span><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #A6ACCD">        </span></span>
<span class="line"><span style="color: #A6ACCD">    </span><span style="color: #82AAFF">plot_images</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">match_images</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #A6ACCD; font-style: italic">figsize</span><span style="color: #89DDFF">=(</span><span style="color: #F78C6C">10</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #F78C6C">10</span><span style="color: #89DDFF">))</span></span>
<span class="line"><span style="color: #A6ACCD">    </span><span style="color: #82AAFF">print</span><span style="color: #89DDFF">()</span></span>
<span class="line"><span style="color: #A6ACCD">    </span><span style="color: #82AAFF">print</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">----------------------------------------------</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">)</span></span></code></pre>
</div><p><img src="./pic/è‡ªå®šä¹‰è®­ç»ƒæ•°æ®å›¾åƒè¯†åˆ«-éªŒè¯çœŸå®ç»“æœ-2024-01-29.png" alt="">
<img src="./pic/è‡ªå®šä¹‰è®­ç»ƒæ•°æ®å›¾åƒè¯†åˆ«-ç»“æœå¯è§†åŒ–-2024-01-29.png" alt="">
<img src="./pic/è‡ªå®šä¹‰è®­ç»ƒæ•°æ®å›¾åƒè¯†åˆ«-ç»“æœæ€»ç»“-2024-01-29.png" alt=""></p>
<h1 id="æ¢ç”¨resnetç½‘ç»œè®­ç»ƒå¯¹æ¯”" tabindex="-1">æ¢ç”¨ResNetç½‘ç»œè®­ç»ƒå¯¹æ¯” <a class="header-anchor" href="#æ¢ç”¨resnetç½‘ç»œè®­ç»ƒå¯¹æ¯”" aria-label="Permalink to &quot;æ¢ç”¨ResNetç½‘ç»œè®­ç»ƒå¯¹æ¯”&quot;">&ZeroWidthSpace;</a></h1>
<div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre v-pre class="shiki material-theme-palenight" ><code><span class="line"><span style="color: #89DDFF">%%</span><span style="color: #A6ACCD">time</span></span>
<span class="line"><span style="color: #676E95; font-style: italic"># è®­ç»ƒæ¨¡å‹</span></span>
<span class="line"></span>
<span class="line"><span style="color: #676E95; font-style: italic"># åŠ è½½ResNet101æ¨¡å‹</span></span>
<span class="line"><span style="color: #A6ACCD">net </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> torchvision</span><span style="color: #89DDFF">.</span><span style="color: #F07178">models</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">resnet101</span><span style="color: #89DDFF">(</span><span style="color: #A6ACCD; font-style: italic">pretrained</span><span style="color: #89DDFF">=True)</span></span>
<span class="line"><span style="color: #A6ACCD">num_features </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> net</span><span style="color: #89DDFF">.</span><span style="color: #F07178">fc</span><span style="color: #89DDFF">.</span><span style="color: #F07178">in_features</span></span>
<span class="line"></span>
<span class="line"><span style="color: #676E95; font-style: italic"># å¢åŠ  dropout</span></span>
<span class="line"><span style="color: #A6ACCD">net</span><span style="color: #89DDFF">.</span><span style="color: #F07178">fc</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> torch</span><span style="color: #89DDFF">.</span><span style="color: #F07178">nn</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">Sequential</span><span style="color: #89DDFF">(</span></span>
<span class="line"><span style="color: #82AAFF">    torch</span><span style="color: #89DDFF">.</span><span style="color: #F07178">nn</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">Dropout</span><span style="color: #89DDFF">(</span><span style="color: #F78C6C">0.5</span><span style="color: #89DDFF">),</span><span style="color: #82AAFF">   </span><span style="color: #676E95; font-style: italic"># å¢åŠ  dropouté¿å…å¤ªå¿«è¿‡æ‹Ÿåˆ</span></span>
<span class="line"><span style="color: #82AAFF">    torch</span><span style="color: #89DDFF">.</span><span style="color: #F07178">nn</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">Linear</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">num_features</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> total_classes_num</span><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #676E95; font-style: italic"># å•å±‚å·ç§¯, æ›¿ä»£äº†vggçš„4096ä¸ªå…¨è¿æ¥å±‚,æ·±,ä½†æ˜¯é€Ÿåº¦è¿˜æ›´å¿«</span></span>
<span class="line"><span style="color: #A6ACCD">net</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">to</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">device</span><span style="color: #89DDFF">)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #A6ACCD">model</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">eval</span><span style="color: #89DDFF">()</span><span style="color: #A6ACCD">  </span><span style="color: #676E95; font-style: italic"># éªŒè¯æ¨¡å—</span></span>
<span class="line"></span>
<span class="line"><span style="color: #A6ACCD">criterion </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> nn</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">CrossEntropyLoss</span><span style="color: #89DDFF">()</span></span>
<span class="line"><span style="color: #A6ACCD">optimizer </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> optim</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">Adam</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">net</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">parameters</span><span style="color: #89DDFF">(),</span><span style="color: #82AAFF"> </span><span style="color: #A6ACCD; font-style: italic">lr</span><span style="color: #89DDFF">=</span><span style="color: #F78C6C">0.0001</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #A6ACCD; font-style: italic">weight_decay</span><span style="color: #89DDFF">=</span><span style="color: #F78C6C">0.01</span><span style="color: #89DDFF">)</span><span style="color: #A6ACCD">  </span><span style="color: #676E95; font-style: italic"># åŠ å…¥äº†l2æ­£åˆ™åŒ–</span></span>
<span class="line"></span>
<span class="line"><span style="color: #A6ACCD">check_iter </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> </span><span style="color: #F78C6C">10</span><span style="color: #A6ACCD"> </span><span style="color: #676E95; font-style: italic"># train check batch size </span></span>
<span class="line"><span style="color: #A6ACCD">train_epoch </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> </span><span style="color: #F78C6C">25</span></span>
<span class="line"><span style="color: #A6ACCD">prefix </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> </span><span style="color: #C792EA">f</span><span style="color: #C3E88D">&quot;20240201_full_32x32_clear_</span><span style="color: #F78C6C">{</span><span style="color: #A6ACCD">total_classes_num</span><span style="color: #F78C6C">}</span><span style="color: #C3E88D">class_l2_2-&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #82AAFF">print</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">batch_size</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> batch_size</span><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #89DDFF; font-style: italic">for</span><span style="color: #A6ACCD"> epoch </span><span style="color: #89DDFF; font-style: italic">in</span><span style="color: #A6ACCD"> </span><span style="color: #82AAFF">range</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">train_epoch</span><span style="color: #89DDFF">):</span></span>
<span class="line"><span style="color: #A6ACCD">    net</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">train</span><span style="color: #89DDFF">()</span><span style="color: #A6ACCD">  </span><span style="color: #676E95; font-style: italic"># æ¯ä¸ªepoch ååˆ‡æ¢è®­ç»ƒæ¨¡å¼, é‚£ä¹ˆä¼šä¸ä¼šä¿dç•™ä¹‹å‰çš„è®­ç»ƒæƒé‡å‘¢?</span></span>
<span class="line"><span style="color: #A6ACCD">    </span></span>
<span class="line"><span style="color: #A6ACCD">    progress_bar </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> </span><span style="color: #82AAFF">tqdm</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">enumerate</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">train_dataloader</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #F78C6C">0</span><span style="color: #89DDFF">),</span><span style="color: #82AAFF"> </span><span style="color: #A6ACCD; font-style: italic">total</span><span style="color: #89DDFF">=</span><span style="color: #82AAFF">len</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">train_dataloader</span><span style="color: #89DDFF">))</span></span>
<span class="line"><span style="color: #A6ACCD">    </span><span style="color: #89DDFF; font-style: italic">for</span><span style="color: #A6ACCD"> i</span><span style="color: #89DDFF">,</span><span style="color: #A6ACCD"> data </span><span style="color: #89DDFF; font-style: italic">in</span><span style="color: #A6ACCD"> progress_bar</span><span style="color: #89DDFF">:</span></span>
<span class="line"><span style="color: #A6ACCD">        inputs</span><span style="color: #89DDFF">,</span><span style="color: #A6ACCD"> labels </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> data  </span><span style="color: #676E95; font-style: italic"># å¿…é¡»è¦float å½’ä¸€åŒ–? æµ®ç‚¹ç±»å‹.</span></span>
<span class="line"><span style="color: #A6ACCD">        inputs</span><span style="color: #89DDFF">,</span><span style="color: #A6ACCD"> labels </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> inputs</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">float</span><span style="color: #89DDFF">().</span><span style="color: #82AAFF">to</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">device</span><span style="color: #89DDFF">),</span><span style="color: #A6ACCD"> labels</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">to</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">device</span><span style="color: #89DDFF">)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #A6ACCD">        optimizer</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">zero_grad</span><span style="color: #89DDFF">()</span></span>
<span class="line"><span style="color: #A6ACCD">        outputs </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> </span><span style="color: #82AAFF">net</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">inputs</span><span style="color: #89DDFF">)</span><span style="color: #A6ACCD">  </span><span style="color: #676E95; font-style: italic"># è¿™ä¸€æ­¥, è¿è¡Œæœ‰é—®é¢˜, è¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢, æ£€æŸ¥ä¸€ä¸‹å›¾ç‰‡æ ¼å¼</span></span>
<span class="line"></span>
<span class="line"><span style="color: #A6ACCD">        loss </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> </span><span style="color: #82AAFF">criterion</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">outputs</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> labels</span><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #A6ACCD">        loss</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">backward</span><span style="color: #89DDFF">()</span></span>
<span class="line"><span style="color: #A6ACCD">        optimizer</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">step</span><span style="color: #89DDFF">()</span></span>
<span class="line"><span style="color: #A6ACCD">        progress_bar</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">set_description</span><span style="color: #89DDFF">(</span><span style="color: #C792EA">f</span><span style="color: #C3E88D">&#39;epoch:</span><span style="color: #F78C6C">{</span><span style="color: #82AAFF">epoch</span><span style="color: #F78C6C">}</span><span style="color: #C3E88D">, loss: </span><span style="color: #F78C6C">{</span><span style="color: #82AAFF">loss </span><span style="color: #89DDFF">/</span><span style="color: #82AAFF"> batch_size</span><span style="color: #C792EA">:.3f</span><span style="color: #F78C6C">}</span><span style="color: #C3E88D">&#39;</span><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #A6ACCD">    </span></span>
<span class="line"><span style="color: #A6ACCD">    </span><span style="color: #89DDFF; font-style: italic">if</span><span style="color: #A6ACCD"> epoch </span><span style="color: #89DDFF">%</span><span style="color: #A6ACCD"> </span><span style="color: #F78C6C">1</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">==</span><span style="color: #A6ACCD"> </span><span style="color: #F78C6C">0</span><span style="color: #89DDFF">:</span><span style="color: #A6ACCD">  </span><span style="color: #676E95; font-style: italic"># æ¯ä¸¤ä¸ªepochè¿›è¡Œä¸€æ¬¡éªŒè¯</span></span>
<span class="line"><span style="color: #A6ACCD">        </span><span style="color: #82AAFF">print</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">å¼€å§‹éªŒè¯....</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #A6ACCD">        net</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">eval</span><span style="color: #89DDFF">()</span></span>
<span class="line"><span style="color: #A6ACCD">        correct </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> </span><span style="color: #F78C6C">0</span><span style="color: #A6ACCD">  </span><span style="color: #676E95; font-style: italic"># è®°å½•æ­£ç¡®é¢„æµ‹çš„æ•°é‡</span></span>
<span class="line"><span style="color: #A6ACCD">        total </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> </span><span style="color: #F78C6C">0</span><span style="color: #A6ACCD">  </span><span style="color: #676E95; font-style: italic"># æ€»çš„æ ·æœ¬æ•°</span></span>
<span class="line"><span style="color: #A6ACCD">        </span><span style="color: #89DDFF; font-style: italic">with</span><span style="color: #A6ACCD"> torch</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">no_grad</span><span style="color: #89DDFF">():</span></span>
<span class="line"><span style="color: #A6ACCD">            </span></span>
<span class="line"><span style="color: #A6ACCD">            progress_bar2 </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> </span><span style="color: #82AAFF">tqdm</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">enumerate</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">train_dataloader</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #F78C6C">0</span><span style="color: #89DDFF">),</span><span style="color: #82AAFF"> </span><span style="color: #A6ACCD; font-style: italic">total</span><span style="color: #89DDFF">=</span><span style="color: #FFCB6B">int</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">len</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">train_dataloader</span><span style="color: #89DDFF">)</span><span style="color: #82AAFF"> </span><span style="color: #89DDFF">*</span><span style="color: #82AAFF"> </span><span style="color: #F78C6C">0.4</span><span style="color: #89DDFF">))</span></span>
<span class="line"><span style="color: #A6ACCD">            </span><span style="color: #89DDFF; font-style: italic">for</span><span style="color: #A6ACCD"> i</span><span style="color: #89DDFF">,</span><span style="color: #A6ACCD"> data </span><span style="color: #89DDFF; font-style: italic">in</span><span style="color: #A6ACCD"> progress_bar2</span><span style="color: #89DDFF">:</span></span>
<span class="line"><span style="color: #A6ACCD">                </span><span style="color: #89DDFF; font-style: italic">if</span><span style="color: #A6ACCD"> i </span><span style="color: #89DDFF">&gt;=</span><span style="color: #A6ACCD"> </span><span style="color: #FFCB6B">int</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">len</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">train_dataloader</span><span style="color: #89DDFF">)</span><span style="color: #82AAFF"> </span><span style="color: #89DDFF">*</span><span style="color: #82AAFF"> </span><span style="color: #F78C6C">0.4</span><span style="color: #89DDFF">):</span></span>
<span class="line"><span style="color: #A6ACCD">                    </span><span style="color: #89DDFF; font-style: italic">break</span></span>
<span class="line"><span style="color: #A6ACCD">                inputs</span><span style="color: #89DDFF">,</span><span style="color: #A6ACCD"> labels </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> data</span></span>
<span class="line"><span style="color: #A6ACCD">                inputs</span><span style="color: #89DDFF">,</span><span style="color: #A6ACCD"> labels </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> inputs</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">float</span><span style="color: #89DDFF">().</span><span style="color: #82AAFF">to</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">device</span><span style="color: #89DDFF">),</span><span style="color: #A6ACCD"> labels</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">to</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">device</span><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #A6ACCD">                outputs </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> </span><span style="color: #82AAFF">net</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">inputs</span><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #A6ACCD">                _</span><span style="color: #89DDFF">,</span><span style="color: #A6ACCD"> predicted </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> torch</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">max</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">outputs</span><span style="color: #89DDFF">.</span><span style="color: #F07178">data</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #F78C6C">1</span><span style="color: #89DDFF">)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #A6ACCD">                total </span><span style="color: #89DDFF">+=</span><span style="color: #A6ACCD"> labels</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">size</span><span style="color: #89DDFF">(</span><span style="color: #F78C6C">0</span><span style="color: #89DDFF">)</span><span style="color: #A6ACCD">  </span><span style="color: #676E95; font-style: italic"># å®é™…çš„æ ·æœ¬æ•°</span></span>
<span class="line"><span style="color: #A6ACCD">                correct </span><span style="color: #89DDFF">+=</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">(</span><span style="color: #A6ACCD">predicted </span><span style="color: #89DDFF">==</span><span style="color: #A6ACCD"> labels</span><span style="color: #89DDFF">).</span><span style="color: #82AAFF">sum</span><span style="color: #89DDFF">().</span><span style="color: #82AAFF">item</span><span style="color: #89DDFF">()</span><span style="color: #A6ACCD">  </span><span style="color: #676E95; font-style: italic"># æ­£ç¡®é¢„æµ‹çš„æ ·æœ¬æ•°</span></span>
<span class="line"><span style="color: #A6ACCD">        </span></span>
<span class="line"><span style="color: #A6ACCD">        accuracy </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> </span><span style="color: #82AAFF">round</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">correct </span><span style="color: #89DDFF">/</span><span style="color: #82AAFF"> total </span><span style="color: #89DDFF">*</span><span style="color: #82AAFF"> </span><span style="color: #F78C6C">100</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #F78C6C">3</span><span style="color: #89DDFF">)</span><span style="color: #A6ACCD">  </span><span style="color: #676E95; font-style: italic"># è®¡ç®—å‡†ç¡®ç‡</span></span>
<span class="line"><span style="color: #A6ACCD">        </span><span style="color: #82AAFF">print</span><span style="color: #89DDFF">(</span><span style="color: #C792EA">f</span><span style="color: #C3E88D">&#39;epoch: </span><span style="color: #F78C6C">{</span><span style="color: #82AAFF">epoch</span><span style="color: #F78C6C">}</span><span style="color: #C3E88D">, Accuracy: </span><span style="color: #F78C6C">{</span><span style="color: #82AAFF">accuracy</span><span style="color: #C792EA">:.3f</span><span style="color: #F78C6C">}</span><span style="color: #C3E88D">&#39;</span><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #A6ACCD">        </span><span style="color: #89DDFF; font-style: italic">if</span><span style="color: #A6ACCD"> accuracy </span><span style="color: #89DDFF">&gt;=</span><span style="color: #A6ACCD"> </span><span style="color: #F78C6C">60</span><span style="color: #89DDFF">:</span><span style="color: #A6ACCD">  </span><span style="color: #676E95; font-style: italic"># å¤ªå°çš„æ ¹æœ¬æ²¡æ¯”è¾ƒä¿å­˜</span></span>
<span class="line"><span style="color: #A6ACCD">            save_model_path </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> </span><span style="color: #C792EA">f</span><span style="color: #C3E88D">&quot;</span><span style="color: #F78C6C">{</span><span style="color: #A6ACCD">prefix</span><span style="color: #F78C6C">}</span><span style="color: #C3E88D">_resnet101_</span><span style="color: #F78C6C">{</span><span style="color: #A6ACCD">epoch</span><span style="color: #F78C6C">}</span><span style="color: #C3E88D">_</span><span style="color: #F78C6C">{</span><span style="color: #A6ACCD">accuracy</span><span style="color: #F78C6C">}</span><span style="color: #C3E88D">.pth&quot;</span></span>
<span class="line"><span style="color: #A6ACCD">            torch</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">save</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">net</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">state_dict</span><span style="color: #89DDFF">(),</span><span style="color: #82AAFF"> save_model_path</span><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #A6ACCD">            </span><span style="color: #82AAFF">print</span><span style="color: #89DDFF">(</span><span style="color: #C792EA">f</span><span style="color: #C3E88D">&quot;model save: &quot;</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> save_model_path</span><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #A6ACCD">        </span></span>
<span class="line"><span style="color: #A6ACCD">    torch</span><span style="color: #89DDFF">.</span><span style="color: #F07178">cuda</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">empty_cache</span><span style="color: #89DDFF">()</span></span>
<span class="line"><span style="color: #82AAFF">print</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">Finished Training</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #A6ACCD">save_model_path </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> </span><span style="color: #C792EA">f</span><span style="color: #C3E88D">&quot;</span><span style="color: #F78C6C">{</span><span style="color: #A6ACCD">prefix</span><span style="color: #F78C6C">}</span><span style="color: #C3E88D">_resnet101_</span><span style="color: #F78C6C">{</span><span style="color: #A6ACCD">epoch</span><span style="color: #F78C6C">}</span><span style="color: #C3E88D">_</span><span style="color: #F78C6C">{</span><span style="color: #A6ACCD">accuracy</span><span style="color: #F78C6C">}</span><span style="color: #C3E88D">.pth&quot;</span></span>
<span class="line"><span style="color: #A6ACCD">torch</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">save</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">net</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">state_dict</span><span style="color: #89DDFF">(),</span><span style="color: #82AAFF"> save_model_path</span><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #82AAFF">print</span><span style="color: #89DDFF">(</span><span style="color: #C792EA">f</span><span style="color: #C3E88D">&quot;model save: &quot;</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> save_model_path</span><span style="color: #89DDFF">)</span></span></code></pre>
</div><h2 id="resnetæ¨¡å‹éªŒè¯" tabindex="-1">ResNetæ¨¡å‹éªŒè¯ <a class="header-anchor" href="#resnetæ¨¡å‹éªŒè¯" aria-label="Permalink to &quot;ResNetæ¨¡å‹éªŒè¯&quot;">&ZeroWidthSpace;</a></h2>
<p>å¾—ç›Šäº<code>ResNet</code>é‡‡ç”¨äº†è·³è·ƒé“¾æ¥, æŸå¤±å€¼èƒ½å¤Ÿæ›´å¥½çš„åœ¨æ›´æ·±çš„ç½‘ç»œä¸­è¿›è¡Œä¼ é€’, è¡¨ç°çš„æ•ˆæœå°±æ˜¯è®­ç»ƒæ›´å®¹æ˜“æ”¶æ•›äº†.</p>
<p>è®­ç»ƒçš„è¾“å‡ºå¦‚ä¸‹, å¯ä»¥çœ‹åˆ°resnetçš„æ”¶æ•›é€Ÿåº¦æå¿«, 10ä¸ªepochä»¥å†…å°±å¯ä»¥è¾¾åˆ°90%çš„å‡†ç¡®ç‡,, è€ŒvggNetåˆ™è¦æ¥è¿‘10ä¸ªepochæ˜¯è¿œè¿œæ²¡æ³•è¾¾åˆ°90%å‡†ç¡®ç‡çš„.<br>
ResNetå‡†ç¡®æ€§æ›´é«˜, æ‰€ä»¥å¦‚æœæ˜¯å®é™…åº”ç”¨äº§å“çš„è¯, å¯ä»¥ç›´æ¥ä¸ç”¨ç®¡å¤è€çš„å†å²åŒ…è¢±äº†, vggå½“ç„¶ä¹Ÿæœ‰å®ƒçš„æ ‡å¿—æ€§æ„ä¹‰. ä½†æ˜¯çœŸå®çœäº‹, ç¡®å®ç›´æ¥é€‰æ¨¡å‹æŒ‘é€‰æ–°ä¸€ç‚¹çš„, ä¼šå°‘ä¸€äº›å‘. ğŸ¤”</p>
<div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre v-pre class="shiki material-theme-palenight" ><code><span class="line"><span style="color: #FFCB6B">epoch:4,</span><span style="color: #A6ACCD"> </span><span style="color: #C3E88D">loss:</span><span style="color: #A6ACCD"> </span><span style="color: #F78C6C">0.005</span><span style="color: #C3E88D">:</span><span style="color: #A6ACCD"> </span><span style="color: #F78C6C">100</span><span style="color: #C3E88D">%</span><span style="color: #89DDFF">|</span><span style="color: #FFCB6B">â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ</span><span style="color: #89DDFF">|</span><span style="color: #A6ACCD"> </span><span style="color: #FFCB6B">85/85</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">[</span><span style="color: #F78C6C">02</span><span style="color: #A6ACCD">:</span><span style="color: #F78C6C">45</span><span style="color: #89DDFF">&lt;</span><span style="color: #F78C6C">00</span><span style="color: #A6ACCD">:</span><span style="color: #F78C6C">00</span><span style="color: #A6ACCD">,  1.95s/it</span><span style="color: #89DDFF">]</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FFCB6B">å¼€å§‹éªŒè¯.</span><span style="color: #82AAFF">...</span></span>
<span class="line"></span>
<span class="line"><span style="color: #F78C6C">100</span><span style="color: #A6ACCD">%</span><span style="color: #89DDFF">|</span><span style="color: #FFCB6B">â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ</span><span style="color: #89DDFF">|</span><span style="color: #A6ACCD"> </span><span style="color: #FFCB6B">34/34</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">[</span><span style="color: #F78C6C">00</span><span style="color: #A6ACCD">:</span><span style="color: #F78C6C">17</span><span style="color: #89DDFF">&lt;</span><span style="color: #F78C6C">00</span><span style="color: #A6ACCD">:</span><span style="color: #F78C6C">00</span><span style="color: #A6ACCD">,  1.90it/s</span><span style="color: #89DDFF">]</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FFCB6B">epoch:</span><span style="color: #A6ACCD"> </span><span style="color: #F78C6C">4</span><span style="color: #C3E88D">,</span><span style="color: #A6ACCD"> </span><span style="color: #C3E88D">Accuracy:</span><span style="color: #A6ACCD"> </span><span style="color: #F78C6C">96.507</span></span>
<span class="line"><span style="color: #FFCB6B">model</span><span style="color: #A6ACCD"> </span><span style="color: #C3E88D">save:</span><span style="color: #A6ACCD">  </span><span style="color: #C3E88D">20240201_full_32x32_clear_906class_l2_2-_resnet101_4_96.507.pth</span></span></code></pre>
</div><p>è½½å…¥è®­ç»ƒåæ¨¡å‹, ä½¿ç”¨ä¸Šé¢vgg16éªŒè¯çš„ä»£ç , è¿›è¡ŒéªŒè¯, å¯¹æ¯”åå‘ç°, æ•´ä½“çš„æ³›åŒ–èƒ½åŠ›, ResNetè¦æ›´å¥½, å¾ˆå¤šVggNetæ²¡èƒ½ç¨³å®šè¯†åˆ«çš„éªŒè¯å›¾ç‰‡, ResNetéƒ½èƒ½æ¯”è¾ƒç¨³å®šçš„ä»¥æ¯”è¾ƒé«˜çš„è¯†åˆ«ç‡è¿›è¡Œè¯†åˆ«.</p>
<h1 id="æ€»ç»“" tabindex="-1">æ€»ç»“ <a class="header-anchor" href="#æ€»ç»“" aria-label="Permalink to &quot;æ€»ç»“&quot;">&ZeroWidthSpace;</a></h1>
<p>ä¸€æ—¶å…´èµ·çš„å°éœ€æ±‚, ä¹Ÿå¾ˆå¤šå°ç»†èŠ‚éœ€è¦å¤„ç†.
å¤§æ‰¹é‡æ•°æ®è¿è¡Œå‰, éœ€è¦å…ˆæŠ½å°‘ä¸€äº›ç±»è¿›è¡Œå°æ‰¹é‡çš„å¿«é€ŸéªŒè¯, å¯¹æ¨¡å‹å’Œè®­ç»ƒæ•°æ®è¿›è¡ŒéªŒè¯. è¿™æ¬¡æˆ‘å°±æ˜¯å…ˆç”¨20ç±»è¿›è¡ŒéªŒè¯, ä¹‹åæ‰è¿›è¡Œ900å¤šç±»çš„è®­ç»ƒ.</p>
<p>ä¸€å¼€å§‹ç”¨vgg, ç”¨çš„æ˜¯224x224çš„å›¾ç‰‡è¾“å…¥, åé¢ä¸ºäº†æé€Ÿ.å› ä¸ºæ˜¯åƒç´ ç”»,åªè¦ä¸è¦å¹³æ»‘, 32x32ä¹Ÿè¶³å¤Ÿæ¸…æ™°, æ‰€ä»¥å°±è°ƒæ•´vggç»“æ„, æ–¹ä¾¿è¿›è¡Œå¢åŠ æ›´å¤šçš„batch_sizeè¿›è¡Œæ›´å¿«çš„è®­ç»ƒ.åŠæ—¶è°ƒæ•´äº†è¾“å…¥å›¾ç‰‡çš„å°ºå¯¸ä»¥å, æˆ‘çš„ç”µè„‘è®­ç»ƒèµ·æ¥ä¹Ÿå¿«äº†å¾ˆå¤š, 40å¤šåˆ†é’Ÿå°±å¯ä»¥å®Œæˆ25è½® 128batch_sizeçš„æ¨¡å‹è®­ç»ƒ, ä½“éªŒè¿˜ä¸é”™!</p>
<p>ç„¶åå°±æ˜¯, å¯ä»¥çš„è¯, ä¸»åŠ¨æŒ‘é€‰æ›´æ–°çš„ä»£ç , è€çš„æ¨¡å‹, ç»å…¸, ä½†æ˜¯æ•ˆæœè¿œä¸å¦‚æ–°ä¸€äº›çš„æ¨¡å‹.ResNetæ›´å¿«æ”¶æ•›, æ›´å¿«è®­ç»ƒ(ç¬‘...)</p>
<p><a href="https://github.com/realzhengyiming/isaac_tools/blob/main/simple_issac_item_recognition-%E5%85%A8%E9%87%8F%E8%AE%AD%E7%BB%83%E7%9A%84%E7%89%88%E6%9C%AC.ipynb" target="_blank" rel="noreferrer">æ¨¡å‹è®­ç»ƒå®Œæ•´ä»£ç </a><br>
<a href="https://github.com/realzhengyiming/isaac_tools/blob/main/isaac_data_spider.py" target="_blank" rel="noreferrer">æ•°æ®è·å–å’Œå¤„ç†çš„å®Œæ•´ä»£ç </a>
ä»£ç éƒ½åœ¨githubä¸Šäº†.<br>
æˆ‘è¦å»ç©æ¸¸æˆäº†, ä»¥æ’’çœŸå¥½ç© : )</p>
<h2 id="åç»­ä¼˜åŒ–" tabindex="-1">åç»­ä¼˜åŒ– <a class="header-anchor" href="#åç»­ä¼˜åŒ–" aria-label="Permalink to &quot;åç»­ä¼˜åŒ–&quot;">&ZeroWidthSpace;</a></h2>
<ul>
<li>å¢åŠ ä¸€ä¸‹çœŸå®çš„æˆªå›¾ä½œä¸ºè®­ç»ƒæ•°æ®, ä»¥è¿›ä¸€æ­¥æé«˜å„ä¸ªç±»åˆ«çš„å‡†ç¡®åº¦</li>
<li>è¿›ä¸€æ­¥å¢åŠ ä¸€äº›å…¶ä»–çš„æ•°æ®å¢å¼º, ä»¥æ›´å¥½çš„æ¨¡æ‹ŸçœŸå®çš„ä½¿ç”¨æƒ…å†µ</li>
</ul>
<ul>
<li>[x] è€ƒè™‘æ¢ç”¨å…¶ä»–æ¨¡å‹(resnetæ›¿æ¢éªŒè¯, æ”¹è¿›çš„æ¨¡å‹æ˜æ˜¾æ›´å¥½, å†å²åŒ…è¢±åº”è¯¥æ—©æ—¥ä¸¢å¼ƒ.)</li>
</ul>
<ul>
<li>éƒ¨ç½²æ¨¡å‹åˆ°ç§»åŠ¨ç«¯, å°è£…æˆåº”ç”¨è¿›è¡Œä½¿ç”¨, æ”¹è®­ç»ƒç›®æ ‡æ£€æµ‹æ¨¡å‹.</li>
</ul>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[LLM Agent è§£è¯»]]></title>
            <link>localhost/blog/blog/posts/2024/llm_agent.html</link>
            <guid>localhost/blog/blog/posts/2024/llm_agent.html</guid>
            <pubDate>Mon, 15 Jan 2024 00:00:00 GMT</pubDate>
            <description><![CDATA[<h1 id="ä»€ä¹ˆæ˜¯llm-agent" tabindex="-1">ä»€ä¹ˆæ˜¯llm Agent <a class="header-anchor" href="#ä»€ä¹ˆæ˜¯llm-agent" aria-label="Permalink to &quot;ä»€ä¹ˆæ˜¯llm Agent&quot;">&ZeroWidthSpace;</a></h1>
<h1 id="å¼•è¨€" tabindex="-1">å¼•è¨€ <a class="header-anchor" href="#å¼•è¨€" aria-label="Permalink to &quot;å¼•è¨€&quot;">&ZeroWidthSpace;</a></h1>
<p><img src="./pic/ragå’Œagentçš„å…³ç³».excalidraw.png" alt="">
ä»£ç†(agent)çš„æ ¸å¿ƒæ€æƒ³æ˜¯ä½¿ç”¨è¯­è¨€æ¨¡å‹æ¥é€‰æ‹©è¦<strong>æ‰§è¡Œ</strong>çš„<strong>ä¸€ç³»åˆ—æ“ä½œ</strong>ã€‚åœ¨é“¾ä¸­ï¼Œä¸€ç³»åˆ—æ“ä½œæ˜¯ç¡¬ç¼–ç çš„ï¼ˆåœ¨ä»£ç ä¸­ï¼‰ã€‚åœ¨ä»£ç†ä¸­ï¼Œè¯­è¨€æ¨¡å‹ç”¨ä½œ<strong>æ¨ç†å¼•æ“</strong>ï¼Œä»¥ç¡®å®šè¦æ‰§è¡Œå“ªäº›æ“ä½œä»¥åŠæŒ‰ä½•ç§é¡ºåºæ‰§è¡Œã€‚</p>
<p>ç®€å•çš„ç†è§£å°±æ˜¯, è®©llmæˆä¸ºå¤§è„‘, ç„¶åé€šè¿‡agentæŠ€æœ¯,å¯ä»¥è®©llmåˆ¤æ–­å’Œä½¿ç”¨å·¥å…·æ‹“å±•ä»–çš„åŠŸèƒ½, ä»¥è¾¾åˆ°å®Œæˆå¤æ‚ä»»åŠ¡çš„ç›®çš„.</p>
]]></description>
            <content:encoded><![CDATA[<h1 id="ä»€ä¹ˆæ˜¯llm-agent" tabindex="-1">ä»€ä¹ˆæ˜¯llm Agent <a class="header-anchor" href="#ä»€ä¹ˆæ˜¯llm-agent" aria-label="Permalink to &quot;ä»€ä¹ˆæ˜¯llm Agent&quot;">&ZeroWidthSpace;</a></h1>
<h1 id="å¼•è¨€" tabindex="-1">å¼•è¨€ <a class="header-anchor" href="#å¼•è¨€" aria-label="Permalink to &quot;å¼•è¨€&quot;">&ZeroWidthSpace;</a></h1>
<p><img src="./pic/ragå’Œagentçš„å…³ç³».excalidraw.png" alt="">
ä»£ç†(agent)çš„æ ¸å¿ƒæ€æƒ³æ˜¯ä½¿ç”¨è¯­è¨€æ¨¡å‹æ¥é€‰æ‹©è¦<strong>æ‰§è¡Œ</strong>çš„<strong>ä¸€ç³»åˆ—æ“ä½œ</strong>ã€‚åœ¨é“¾ä¸­ï¼Œä¸€ç³»åˆ—æ“ä½œæ˜¯ç¡¬ç¼–ç çš„ï¼ˆåœ¨ä»£ç ä¸­ï¼‰ã€‚åœ¨ä»£ç†ä¸­ï¼Œè¯­è¨€æ¨¡å‹ç”¨ä½œ<strong>æ¨ç†å¼•æ“</strong>ï¼Œä»¥ç¡®å®šè¦æ‰§è¡Œå“ªäº›æ“ä½œä»¥åŠæŒ‰ä½•ç§é¡ºåºæ‰§è¡Œã€‚</p>
<p>ç®€å•çš„ç†è§£å°±æ˜¯, è®©llmæˆä¸ºå¤§è„‘, ç„¶åé€šè¿‡agentæŠ€æœ¯,å¯ä»¥è®©llmåˆ¤æ–­å’Œä½¿ç”¨å·¥å…·æ‹“å±•ä»–çš„åŠŸèƒ½, ä»¥è¾¾åˆ°å®Œæˆå¤æ‚ä»»åŠ¡çš„ç›®çš„.</p>
<hr>
<h1 id="å·¥ä½œæµç¨‹" tabindex="-1">å·¥ä½œæµç¨‹ <a class="header-anchor" href="#å·¥ä½œæµç¨‹" aria-label="Permalink to &quot;å·¥ä½œæµç¨‹&quot;">&ZeroWidthSpace;</a></h1>
<p>æœ¬è´¨ä¸Šå°±æ˜¯é€šè¿‡å¤šè½®å¯¹è¯, è¯»å–ç»“æœ,è§£è¯»ç»“æœ, å¤šè½®æ¥å®Œæˆç¡®å®šè°ƒç”¨æ„å›¾çš„æ„æ€.</p>
<p>æµç¨‹ç®€å•çš„è¯´,æœ‰å‡ æ­¥:</p>
<ol>
<li>ç”¨æˆ·è¾“å…¥é—®é¢˜</li>
<li>é€šè¿‡prompt ç¼–å†™æ€è€ƒæ„å›¾(éœ€è¦llmæœ¬èº«èƒ½åŠ›æ”¯æŒ), è®©llmä½œä¸ºæ¨ç†çš„å¤§è„‘, è¦æ±‚å…¶ä»ç”¨æˆ·è¾“å…¥çš„è‡ªç„¶è¯­è¨€ä¸­, åœ¨å·¥å…·åº“ä¸­é€‰æ‹©å¥½åº”è¯¥ä½¿ç”¨çš„å·¥å…·</li>
<li>ç„¶åè®©llmæŒ‰ç…§é¢„è®¾å¥½çš„æ ¼å¼ä»é—®é¢˜ä¸­æå–å‡ºä½¿ç”¨è¿™ä¸ªå·¥å…·æ‰€éœ€è¦çš„å…¥å‚(ä¹Ÿæ˜¯é€šè¿‡prompt)</li>
<li>æœ€åè®©exexution engine (å¸¸è§„ç®—æ³•ç¼–å†™çš„æå–å‚æ•°åŒ¹é…å’Œæ‰§è¡Œå·¥å…·), è¯»å–llmçš„å‚æ•°å’Œå·¥å…·ä½¿ç”¨çš„é€‰æ‹©ç»“æœ, æ‰§è¡Œç»“æœ, å¹¶ä¸”è¿”å›ç»™ç”¨æˆ·.</li>
</ol>
<p>exexution engine:  è¿™ä¸ªå°±æ˜¯åšå­—ç¬¦ä¸²å’Œè°ƒç”¨å…·ä½“åŠŸèƒ½çš„æ˜ å°„åŠŸèƒ½, ä¹‹å‰å°±å¡ç€è¿™å„¿, ä¸çŸ¥é“å…·ä½“çš„å¯èƒ½æ€§æ˜¯å¦‚ä½•åšåˆ°çš„,  å¯ä»¥é€šè¿‡æ­£åˆ™,æˆ–è€…frontmatter(çœ‹å…·ä½“è®¾è®¡çš„æ ¼å¼).</p>
<p>è®©å¤§è¯­è¨€æ¨¡å‹é€šè¿‡json çš„æ ¼å¼ç”Ÿæˆå›ç­”,è¿™ä¸ªå°±å¾ˆæ£’, æ€»ä½“çš„æ„æ€å°±æ˜¯è¿™æ ·ä¸€ä¸ªæ„æ€, ç„¶åè§£æjsonæ¯”è¾ƒç®€å•, æ‰€ä»¥ä¸éœ€è¦é‡æ–°è®¾è®¡å­—ç¬¦ä¸²æ ¼å¼.</p>
<p>(ä¹‹å‰æˆ‘ä»¬è®©llmæŒ‰ç…§æˆ‘ä»¬çš„æ ¼å¼è¦æ±‚ç”Ÿæˆä¸‰ç»´æ•°æ®çš„jsonæ ¼å¼, ç„¶åç›´æ¥è§£æé‚£å°±æ˜¯ä¸‰ç»´æ•°æ®äº†, è¿™å…¶å®å°±æ˜¯ agentçš„æ€æƒ³!)</p>
<blockquote>
<p><a href="https://python.langchain.com/docs/modules/agents/" target="_blank" rel="noreferrer">Agents | ğŸ¦œï¸ğŸ”— Langchain</a>
<a href="https://www.zhihu.com/question/604480991/answer/3080252928" target="_blank" rel="noreferrer">(99+ å°ç§ä¿¡ / 80 æ¡æ¶ˆæ¯) LangChainçš„agentæ˜¯å¦‚ä½•æŠŠè‡ªå·±çš„å‡½æ•°ä¸¢ç»™LLMsçš„ï¼Œæ˜¯promptå—ï¼Ÿ - çŸ¥ä¹ (zhihu.com)</a></p>
</blockquote>
<h1 id="æ€è€ƒ" tabindex="-1">æ€è€ƒ <a class="header-anchor" href="#æ€è€ƒ" aria-label="Permalink to &quot;æ€è€ƒ&quot;">&ZeroWidthSpace;</a></h1>
<p><strong>é—®é¢˜:</strong>
ä¸ºä»€ä¹ˆllmèƒ½å¤Ÿç†è§£æˆ‘è®©ä»–ä»¥ç‰¹å®šæ ¼å¼çš„jsonç”Ÿæˆå›ç­”è¿™ç§ä»»åŠ¡, è®­ç»ƒçš„æ—¶å€™éœ€è¦ç‰¹åœ°çš„å–‚å®ƒè¿™ç±»jsonæ•°æ®å—,è¿˜æ˜¯ä¸éœ€è¦?</p>
<p><strong>GPTå›ç­”:</strong>
LLMå¯ä»¥ç†è§£å¹¶ç”Ÿæˆç‰¹å®šæ ¼å¼çš„JSONæ˜¯å› ä¸ºå…¶åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­æ¥æ”¶åˆ°çš„å¤§é‡æ•°æ®åŒ…å«å¤šæ ·æ€§çš„ä¿¡æ¯ï¼Œå¹¶ä¸”ä½¿ç”¨äº†å¼ºå¤§çš„æœºå™¨å­¦ä¹ ç®—æ³•æ¥æŒ–æ˜è¿™äº›æ•°æ®çš„æ¨¡å¼ã€‚</p>
<p>è¿™äº›æ•°æ®å¯èƒ½åŒ…æ‹¬å„ç§ä»»åŠ¡ï¼ŒåŒ…æ‹¬ç”Ÿæˆç‰¹å®šæ ¼å¼çš„JSONã€‚å› æ­¤ï¼Œå³ä½¿æ²¡æœ‰ç‰¹æ„å°†â€œç”Ÿæˆç‰¹å®šæ ¼å¼çš„JSONâ€ä½œä¸ºè®­ç»ƒä»»åŠ¡ï¼Œåªè¦è®­ç»ƒæ•°æ®åŒ…å«äº†è¶³å¤Ÿä¸°å¯Œå’Œå¤šæ ·çš„ä»»åŠ¡ï¼ŒLLMä¹Ÿèƒ½å­¦ä¹ åˆ°è¿™ä¸ªæŠ€èƒ½ã€‚</p>
<p>é‡åˆ°è¿™ç±»ä»»åŠ¡æ—¶ï¼ŒLLMä¼šä¾æ®ç”¨æˆ·çš„è¾“å…¥ï¼Œç†è§£ä»»åŠ¡éœ€æ±‚ï¼Œå¹¶ç”¨å…¶å­¦ä¹ çš„æ¨¡å¼ç”Ÿæˆç›¸åº”æ ¼å¼çš„JSONè¯­å¥ï¼Œå®Œæˆä»»åŠ¡ã€‚</p>
<p>æ€»çš„æ¥è¯´ï¼ŒLLMçš„å¼ºå¤§ä¸»è¦åæ˜ åœ¨ä¸¤ç‚¹ã€‚é¦–å…ˆï¼Œå®ƒçš„è®­ç»ƒæ•°æ®æ¶µç›–äº†å¹¿æ³›çš„å†…å®¹ï¼Œä½¿å…¶èƒ½å¤Ÿå¤„ç†å¤šæ ·æ€§çš„ä»»åŠ¡ï¼›å…¶æ¬¡ï¼Œå®ƒçš„æœºå™¨å­¦ä¹ ç®—æ³•èƒ½æœ‰æ•ˆåˆ©ç”¨è¿™äº›æ•°æ®å­¦ä¹ äº†å¦‚ä½•å¤„ç†å„ç±»ä»»åŠ¡ï¼ŒåŒ…æ‹¬ç”Ÿæˆç‰¹å®šæ ¼å¼çš„JSONã€‚</p>
<h1 id="llm-agentåº”ç”¨" tabindex="-1">llm Agentåº”ç”¨ <a class="header-anchor" href="#llm-agentåº”ç”¨" aria-label="Permalink to &quot;llm Agentåº”ç”¨&quot;">&ZeroWidthSpace;</a></h1>
<p>å’ŒRAGçš„å…³ç³»:
è¿™ç§å½¢å¼çš„ä¸€ä¸ªç‰¹ç‚¹å°±æ˜¯, ç›®å‰å¢å¼ºçš„è¿˜æ˜¯ä¾§é‡äºè‡ªç„¶è¯­è¨€çš„ä»»åŠ¡å’Œå·¥ä½œ. å’Œ<code>llm agent</code>ç›¸æ¯”,  <code>agent</code>çš„åŠŸèƒ½å¯ä»¥å›Šæ‹¬è¿™ä¸ª, agentè¿˜å¯ä»¥å¤„ç†éè‡ªç„¶è¯­è¨€çš„, ç±»ä¼¼apiä¹‹ç±»çš„å·¥ä½œ. æ‰€ä»¥çœ‹èµ·æ¥, agentå…¶å®å¯ä»¥è¦†ç›–éƒ¨åˆ†RAGçš„æ¦‚å¿µèŒƒå›´.</p>
<p>æ‰€ä»¥ä»¥åéæ–‡æœ¬çš„ä»»åŠ¡æ—¶å€™å°±æ˜¯agentæ€ç»´.
<img src="./pic/ragå’Œagentçš„å…³ç³».excalidraw.png" alt=""></p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[vitepresså’Œobsidianä¸€é”®èˆ’é€‚å†™æ–‡/å‘æ–‡]]></title>
            <link>localhost/blog/blog/posts/2024/vitepress_obsidian.html</link>
            <guid>localhost/blog/blog/posts/2024/vitepress_obsidian.html</guid>
            <pubDate>Sun, 14 Jan 2024 00:00:00 GMT</pubDate>
            <description><![CDATA[<h1 id="å¼•è¨€" tabindex="-1">å¼•è¨€ <a class="header-anchor" href="#å¼•è¨€" aria-label="Permalink to &quot;å¼•è¨€&quot;">&ZeroWidthSpace;</a></h1>
<p>åœ¨æ­¤ä¹‹å‰å¾ˆé•¿æ—¶é—´æˆ‘éƒ½æŠ˜è…¾è¿‡å¥½å‡ ä¸ªåšå®¢Â ğŸ¥², æœ‰django + mdui è‡ªå»ºåšå®¢; æœ‰wordpress æ¡†æ¶åšå®¢...ä½†æ˜¯æˆ‘æ¯æ¬¡å›å¤´éƒ½ä¼šå‘ç°, ä¸€å¹´åˆ°å¤´æ²¡å†™å‡ ç¯‡å†…å®¹.
å¤ç›˜ä¸€ä¸‹, æ€»å¾—æ¥è¯´æ¥æ¥å»å»éƒ½æ˜¯ä¸€ä¸‹è¿™å‡ ä¸ªé—®é¢˜çº ç¼ ç€:</p>
<ol>
<li>å†™ä½œä¸æ–¹ä¾¿: å¯è§†åŒ–å¯Œæ–‡æœ¬ç¼–è¾‘å™¨å®åœ¨ç”¨å¾—éš¾å—</li>
<li>å‘å¸ƒä¸æ–¹ä¾¿: åªèƒ½ç”¨ç½‘é¡µè¿›è¡Œç¼–è¾‘çš„è¯, æµç¨‹ç¹ç</li>
<li>ç«™ç‚¹è®¿é—®å¡é¡¿:(æœ¬äººæœåŠ¡å™¨é…ç½®æ˜¯æœ€ä½æ¡£)</li>
<li>ä¹ æƒ¯éš¾ä»¥å…»æˆ: è‡ªå·±è™½ç„¶è¯´æœ‰å†™ç¬”è®°çš„ä¹ æƒ¯, ä½†æ˜¯å¹¶æ²¡æœ‰æ‰“å¼€ç½‘é¡µå†™æ–‡ç« çš„ä¹ æƒ¯, åŠ ä¸Š(1,2,3çš„éš¾å—ç”¨æˆ·ä½“éªŒ, è¿›ä¸€æ­¥åœ¨å¼€å¤´çš„çƒ­æƒ…ç»“æŸå, æ‰“æ¶ˆäº†è‡ªå·±å†™ä¸œè¥¿çš„çƒ­æƒ…)</li>
</ol>
]]></description>
            <content:encoded><![CDATA[<h1 id="å¼•è¨€" tabindex="-1">å¼•è¨€ <a class="header-anchor" href="#å¼•è¨€" aria-label="Permalink to &quot;å¼•è¨€&quot;">&ZeroWidthSpace;</a></h1>
<p>åœ¨æ­¤ä¹‹å‰å¾ˆé•¿æ—¶é—´æˆ‘éƒ½æŠ˜è…¾è¿‡å¥½å‡ ä¸ªåšå®¢Â ğŸ¥², æœ‰django + mdui è‡ªå»ºåšå®¢; æœ‰wordpress æ¡†æ¶åšå®¢...ä½†æ˜¯æˆ‘æ¯æ¬¡å›å¤´éƒ½ä¼šå‘ç°, ä¸€å¹´åˆ°å¤´æ²¡å†™å‡ ç¯‡å†…å®¹.
å¤ç›˜ä¸€ä¸‹, æ€»å¾—æ¥è¯´æ¥æ¥å»å»éƒ½æ˜¯ä¸€ä¸‹è¿™å‡ ä¸ªé—®é¢˜çº ç¼ ç€:</p>
<ol>
<li>å†™ä½œä¸æ–¹ä¾¿: å¯è§†åŒ–å¯Œæ–‡æœ¬ç¼–è¾‘å™¨å®åœ¨ç”¨å¾—éš¾å—</li>
<li>å‘å¸ƒä¸æ–¹ä¾¿: åªèƒ½ç”¨ç½‘é¡µè¿›è¡Œç¼–è¾‘çš„è¯, æµç¨‹ç¹ç</li>
<li>ç«™ç‚¹è®¿é—®å¡é¡¿:(æœ¬äººæœåŠ¡å™¨é…ç½®æ˜¯æœ€ä½æ¡£)</li>
<li>ä¹ æƒ¯éš¾ä»¥å…»æˆ: è‡ªå·±è™½ç„¶è¯´æœ‰å†™ç¬”è®°çš„ä¹ æƒ¯, ä½†æ˜¯å¹¶æ²¡æœ‰æ‰“å¼€ç½‘é¡µå†™æ–‡ç« çš„ä¹ æƒ¯, åŠ ä¸Š(1,2,3çš„éš¾å—ç”¨æˆ·ä½“éªŒ, è¿›ä¸€æ­¥åœ¨å¼€å¤´çš„çƒ­æƒ…ç»“æŸå, æ‰“æ¶ˆäº†è‡ªå·±å†™ä¸œè¥¿çš„çƒ­æƒ…)</li>
</ol>
<hr>
<p>åˆšå¥½, ä»Šå¹´2024å¹´å¼€å¤´, æˆ‘å‘ç°äº†ä¸€ä¸ªä¸é”™çš„ç¬”è®°åº”ç”¨obsidian, åˆæ­¥ä½“éªŒä¸‹æ¥, æˆ‘ç›´æ¥æ”¾å¼ƒäº†notion (ä½¿ç”¨notionçš„æ—¶å€™é‡åˆ°äº†ä¸Šé¢åˆ—å‡ºæ¥çš„é—®é¢˜).  å¹¶ä¸”æœºç¼˜å·§åˆæŸ¥é˜…èµ„æ–™ä¹‹æ—¶, ä¹Ÿè®©æˆ‘çœ‹åˆ°äº†vitepress åšå®¢, äºæ˜¯ä¸¤è€…ä¸€æ‹å³åˆ, æœ‰äº†æ–°æ–‡ç« å’Œè¿™ä¸ªæ–°åšå®¢.</p>
<h1 id="æ€è·¯" tabindex="-1">æ€è·¯ <a class="header-anchor" href="#æ€è·¯" aria-label="Permalink to &quot;æ€è·¯&quot;">&ZeroWidthSpace;</a></h1>
<p>ç»„åˆçš„æµç¨‹ç»“æ„å›¾å¦‚ä¸‹:<br>
<img src="./pic/vitepress_obsidian_combine_struct.png" alt=""></p>
<h2 id="vitepress" tabindex="-1">vitepress <a class="header-anchor" href="#vitepress" aria-label="Permalink to &quot;vitepress&quot;">&ZeroWidthSpace;</a></h2>
<p>å¯ä»¥åŸºäºmarkdown ç”Ÿæˆé™æ€åšå®¢é¡µé¢çš„ç®€çº¦æ¡†æ¶, æˆ‘å¾ˆå–œæ¬¢ä»–ç®€æ´æœ´ç´ çš„ä¸»é¢˜é£æ ¼. å¯ä»¥æ¸…æ™°ç®€æ´èˆ’é€‚çš„å±•ç¤ºmarkdownæ–‡ç« å†…å®¹, éƒ¨ç½²æ¨¡å¼,å¯ä»¥buildæˆdisté™æ€èµ„æº. æ–¹ä¾¿éƒ¨ç½²åœ¨è½»é‡çº§çš„æœåŠ¡å™¨ä¸Š.</p>
<h2 id="obsidian" tabindex="-1">Obsidian <a class="header-anchor" href="#obsidian" aria-label="Permalink to &quot;Obsidian&quot;">&ZeroWidthSpace;</a></h2>
<p>markdownçš„ç¬”è®°åº”ç”¨, å¾ˆå¥½ç”¨.ç„¶åä»–è¿˜æ”¯æŒå¾ˆå¤šæ’ä»¶.
æ­¤å¤„é€šè¿‡ç”µè„‘å®¢æˆ·ç«¯ä¸Šå®‰è£…obsidian <code>shell commands</code>æ’ä»¶, é…ç½®å¥½ä¸€é”®æ‰§è¡Œçš„å‘½ä»¤, ä½¿ç”¨èµ·æ¥å°±å¯ä»¥å¾ˆæ–¹ä¾¿äº†, æˆ‘é…ç½®çš„å‘½ä»¤å¦‚ä¸‹:<br>
<img src="./pic/vitepress_obsidian-plus-command.png" alt="">
å‘½ä»¤è§£é‡Š:
è§¦å‘æœ¬åœ°åŒæ–‡ä»¶å¤¹ä¸‹çš„vitepresså¯¹markdownè¿›è¡Œç¼–è¯‘, ç„¶åæäº¤åˆ°githubä¸Š,
å†å¼€å¯<code>/</code>æ–œæ è§¦å‘é‡æ–°æ„å»ºå’Œpushåˆ°github, ä¸€é”®æ“ä½œäº†, éå¸¸çš„æ–¹ä¾¿!</p>
<h2 id="github" tabindex="-1">github <a class="header-anchor" href="#github" aria-label="Permalink to &quot;github&quot;">&ZeroWidthSpace;</a></h2>
<p>githubçš„ä»“åº“æ—¢å¯ä»¥ä½œä¸ºäº‘å¤‡ä»½ç”¨, ä¹Ÿå¯ä»¥ä½œä¸ºè§¦å‘å™¨, åˆ©ç”¨å…¶ä¸Šçš„webhookåŠŸèƒ½, å†æ£€æµ‹åˆ°pushå‘½ä»¤çš„æ—¶å€™, ç»™<code>åšå®¢æœåŠ¡å™¨</code>å‘é€webhook ä¿¡æ¯è¯·æ±‚. ç„¶åè§¦å‘<code>åšå®¢æœåŠ¡å™¨</code>ä¸Šè¿›è¡Œæ‹‰å–å’Œæ›´æ–°æ“ä½œ.<br>
æœåŠ¡å™¨ä¸Šçš„ç®€å•webhooké‡å¯æ¥æ”¶ç«¯, æˆ‘ç›´æ¥ç¼–å†™äº†ä¸€ä¸ªåŸºäºflaskç®€å•æœåŠ¡, åŠŸèƒ½å¾ˆç®€å•,å°±æ˜¯ææ¥gitæœ€æ–°ä»£ç (åšæ–‡é™æ€æ–‡ä»¶), ç„¶åå¤åˆ¶åˆ°æŒ‡å®šä½ç½®, è®©nginxé‡è½½,å®Œæˆæ›´æ–°.</p>
<h2 id="nginx" tabindex="-1">Nginx <a class="header-anchor" href="#nginx" aria-label="Permalink to &quot;Nginx&quot;">&ZeroWidthSpace;</a></h2>
<p>ä½œä¸ºä¸€ä¸ªé«˜æ€§èƒ½é™æ€é¡µé¢æœåŠ¡å™¨, ç”¨èµ·æ¥ä¹Ÿæ˜¯éå¸¸çš„ç®€å•å’Œå®¹æ˜“, ç‰¹åˆ«å¯¹äºæˆ‘è¿™ç§,åšå®¢æœåŠ¡å™¨é…ç½®éå¸¸ä½çš„ä½¿ç”¨è€…æ¥è¯´, ä»¥å‰çš„wordpress/ django, éƒ½éœ€è¦å®‰è£…æ•°æ®åº“, æˆ–è€…å ç”¨å¾ˆå¤šèµ„æº, å®‰è£…å¾ˆå¤šç¯å¢ƒä¾èµ–, æœ‰äº†nginx + vitepress å°±ä¸éœ€è¦è€ƒè™‘è¿™ä¹ˆå¤šäº†. ç›´æ¥è®©ä»–å¤„ç†vitepress buildåçš„diståšå®¢é™æ€èµ„æº, ç®€ç›´èˆ’æœ.
nginxé…ç½®ä¹Ÿå¾ˆç®€å•, å®‰è£…å¥½å, nginx å³å¯å¯åŠ¨.</p>
<div class="language-nginx"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre v-pre class="shiki material-theme-palenight" ><code><span class="line"><span style="color: #C792EA">server</span><span style="color: #A6ACCD"> {  </span></span>
<span class="line"><span style="color: #A6ACCD">Â Â Â </span><span style="color: #89DDFF">Â listen </span><span style="color: #A6ACCD">80</span><span style="color: #89DDFF">;</span><span style="color: #A6ACCD">  </span></span>
<span class="line"><span style="color: #A6ACCD">Â Â Â </span><span style="color: #89DDFF">Â server_name </span><span style="color: #A6ACCD">[yourdomain.com](https://yourdomain.com/ </span><span style="color: #C3E88D">&quot;https://yourdomain.com&quot;</span><span style="color: #A6ACCD">)</span><span style="color: #89DDFF">;</span><span style="color: #A6ACCD"> </span><span style="color: #676E95; font-style: italic"># å°†æ­¤å¤„æ¢æˆä½ çš„åŸŸåæˆ–è€…å…¬ç½‘ IP  </span></span>
<span class="line"><span style="color: #A6ACCD">  </span></span>
<span class="line"><span style="color: #A6ACCD">Â Â Â Â </span><span style="color: #C792EA">location</span><span style="color: #A6ACCD"> </span><span style="color: #FFCB6B">/ </span><span style="color: #A6ACCD">{  </span></span>
<span class="line"><span style="color: #A6ACCD">Â Â Â Â Â Â Â </span><span style="color: #89DDFF">Â root </span><span style="color: #A6ACCD">/var/www/blog/dist</span><span style="color: #89DDFF">;</span><span style="color: #A6ACCD"> </span><span style="color: #676E95; font-style: italic"># å°†æ­¤å¤„ä¿®æ”¹ä¸ºä½ çš„åšå®¢é™æ€é¡µé¢å­˜æ”¾çš„è·¯å¾„  </span></span>
<span class="line"><span style="color: #A6ACCD">Â Â Â Â Â Â Â </span><span style="color: #89DDFF">Â index </span><span style="color: #A6ACCD">index.html</span><span style="color: #89DDFF">;</span><span style="color: #A6ACCD"> </span><span style="color: #676E95; font-style: italic"># è®¾å®šé»˜è®¤è®¿é—®çš„ç½‘é¡µæ–‡ä»¶  </span></span>
<span class="line"><span style="color: #A6ACCD">Â Â Â Â Â Â Â </span><span style="color: #89DDFF">Â try_files $</span><span style="color: #A6ACCD">uri </span><span style="color: #89DDFF">$</span><span style="color: #A6ACCD">uri/ </span><span style="color: #F78C6C">=404</span><span style="color: #89DDFF">;</span><span style="color: #A6ACCD"> </span><span style="color: #676E95; font-style: italic"># æŒ‰è¯·æ±‚çš„URIæ¥å¯»æ‰¾æ–‡ä»¶ï¼Œæ‰¾ä¸åˆ°åˆ™è¿”å›404  </span></span>
<span class="line"><span style="color: #A6ACCD">Â Â Â Â }  </span></span>
<span class="line"><span style="color: #A6ACCD">}</span></span></code></pre>
</div><p>æ›´æ–°æ¨é€ä¹Ÿåªéœ€è¦<code>nginx -s reload</code>å°±å¯ä»¥å®Œæˆ.</p>
<h2 id="æ€»ç»“" tabindex="-1">æ€»ç»“ <a class="header-anchor" href="#æ€»ç»“" aria-label="Permalink to &quot;æ€»ç»“&quot;">&ZeroWidthSpace;</a></h2>
<p>obsidian å†™ç¬”è®°/åšæ–‡ --&gt; vitepress build --&gt; github --&gt; nginx.<br>
è¯¦ç»†è¯·æŸ¥çœ‹ä»“åº“ä»£ç . ä½“éªŒéå¸¸ç®€å•å’Œèˆ’æœ! è¿™ä¸‹æ²¡æœ‰ç†ç”±ä¸è¾“å‡ºæ–‡ç« äº†ğŸ¤¡hhh...</p>
<p>æ‹“å±•:<br>
obsidiançš„<code>shell commands</code>æ’ä»¶å¯ä»¥è‡ªå®šä¹‰æ‰§è¡Œcmdå‘½ä»¤. æ‰€ä»¥,ä¸€åˆ‡çš†æœ‰å¯èƒ½, æ¯”å¦‚åç»­å¦‚æœæœ‰å¤šå¹³å°çš„å‘æ–‡éœ€æ±‚, é‚£ç›´æ¥ç¼–å†™å¥½å¯¹åº”å¹³å°çš„å‘æ–‡çš„è‡ªåŠ¨åŒ–ä»£ç , ç„¶å,åªéœ€è¦åœ¨ <code>shell command</code>ä¸­å¢åŠ ä¸€æ¡è§¦å‘å‘½ä»¤å°±å¯ä»¥äº†. çœŸæ­£åšåˆ°, ä¸€é”®å†™æ–‡/ å‘æ–‡!</p>
<blockquote>
<p><a href="https://github.com/realzhengyiming/YiMingBlog" target="_blank" rel="noreferrer">realzhengyiming/YiMingBlog: a... new blog again</a></p>
</blockquote>
]]></content:encoded>
        </item>
    </channel>
</rss>